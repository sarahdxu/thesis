DNR_TOTAL_YEARS<-NULL
first_gift<-NULL
last_gift<-NULL
last_gift_amount<-NULL
last_gift_for<-NULL
donations<-NULL
d<-NULL
donations1<-NULL
split<-NULL
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
#   donations2<-NULL
#   donatoins2<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
lbw.for.lm<-na.omit(lbw.for.lm)
res.bestglm<-
bestglm(Xy=lbw.for.lm,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
best.model.lm1<-lm(donations~rho+TG2+PGG+SRA4+SRA5+SRA6,data=train)
best.model.lm2<-lm(donations~rho+TG2+UG1+PGG+SRA4+SRA5+SRA6,data=train)
best.model.lm3<-lm(donations~rho+TG2+PGG+SRA1+SRA4+SRA5+SRA6,data=train)
best.model.lm4<-lm(donations~rho+TG2+PGG+SRA2+SRA4+SRA5+SRA6,data=train)
best.model.lm5<-lm(donations~rho+TG2+UG1+PGG+SRA1+SRA4+SRA5+SRA6,data=train)
stargazer(best.model.lm5, best.model.lm2,best.model.lm3,best.model.lm4,best.model.lm1, type="latex",
dep.var.labels=c("Log(Donations)"),
covariate.labels=c("Rho","Trust2", "Ultimatum1",
"SRA1", "SRA2", "SRA4", "SRA5", "SRA6"))
summary(best.model.log)
mean((test$donated - predict.lm(best.model.lm1, test)) ^ 2)
library(glmnet)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
lbw.for.lm<-within(train, {
y<-donations
ID<-NULL
ResponseId<-NULL
GENDER<-NULL
CLASS_YR<-NULL
MAJOR<-NULL
current_donor_status<-NULL
DNR_GIVING<-NULL
DNR_TOTAL_YEARS<-NULL
first_gift<-NULL
last_gift<-NULL
last_gift_amount<-NULL
last_gift_for<-NULL
donations<-NULL
d<-NULL
donations1<-NULL
split<-NULL
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
#   donations2<-NULL
#   donatoins2<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
View(lbw.for.lm)
View(train)
lbw.for.lm<-within(train, {
y<-donations
ID<-NULL
ResponseId<-NULL
GENDER<-NULL
CLASS_YR<-NULL
MAJOR<-NULL
current_donor_status<-NULL
DNR_GIVING<-NULL
DNR_TOTAL_YEARS<-NULL
first_gift<-NULL
last_gift<-NULL
last_gift_amount<-NULL
last_gift_for<-NULL
donations<-NULL
d<-NULL
donations1<-NULL
split<-NULL
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
donations2<-NULL
donatoins2<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
lbw.for.lm<-na.omit(lbw.for.lm)
res.bestglm<-
bestglm(Xy=lbw.for.lm,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
best.model.lm1<-lm(donations~rho+TG2+PGG+SRA4+SRA5+SRA6,data=train)
best.model.lm2<-lm(donations~rho+TG2+UG1+PGG+SRA4+SRA5+SRA6,data=train)
best.model.lm3<-lm(donations~rho+TG2+PGG+SRA1+SRA4+SRA5+SRA6,data=train)
best.model.lm4<-lm(donations~rho+TG2+PGG+SRA2+SRA4+SRA5+SRA6,data=train)
best.model.lm5<-lm(donations~rho+TG2+UG1+PGG+SRA1+SRA4+SRA5+SRA6,data=train)
stargazer(best.model.lm5, best.model.lm2,best.model.lm3,best.model.lm4,best.model.lm1, type="latex",
dep.var.labels=c("Log(Donations)"),
covariate.labels=c("Rho","Trust2", "Ultimatum1",
"SRA1", "SRA2", "SRA4", "SRA5", "SRA6"))
summary(best.model.log)
mean((test$donated - predict.lm(best.model.lm1, test)) ^ 2)
library(glmnet)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
coef(cv.out,s=lambda_1se)
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
lbw.for.lm1<-within(test, {
y<-donations
ID<-NULL
ResponseId<-NULL
GENDER<-NULL
CLASS_YR<-NULL
MAJOR<-NULL
current_donor_status<-NULL
DNR_GIVING<-NULL
DNR_TOTAL_YEARS<-NULL
first_gift<-NULL
last_gift<-NULL
last_gift_amount<-NULL
last_gift_for<-NULL
donations<-NULL
d<-NULL
donations1<-NULL
split<-NULL
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
donations2<-NULL
donatoins2<-NULL
})
lbw.for.lm1<-na.omit(lbw.for.lm1)
xtest<-model.matrix(y~.,lbw.for.lm1)[,-1]
ytest<-lbw.for.lm1$y
yhat<-predict(cv.out,s=lambda_min,newx=xtest)
mse<-mean((ytest-yhat)^2)
mse
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
mood<-lm(donations~rho+avgreturn+pgg+SRA4+SRA5+SRA6, data=data)
mood<-lm(donations~rho+avgreturn+PGG+SRA4+SRA5+SRA6, data=data)
stargazer(mood, type="latex",
dep.var.labels=c("Log(Donations)")
)
mood<-lm(donations~rho+avgreturn+PGG+SRA4+SRA5+SRA6, data=lbw.for.lm)
mood<-lm(y~rho+avgreturn+PGG+SRA4+SRA5+SRA6, data=lbw.for.lm)
stargazer(mood, type="latex",
dep.var.labels=c("Log(Donations)")),
covariate.labels=c("Rho","Trust2", "Ultimatum1",
"SRA1", "SRA2", "SRA4", "SRA5", "SRA6"))
stargazer(mood, type="latex",
dep.var.labels=c("Log(Donations)"))
lbw.for.lm1<-within(test, {
y<-donations
ID<-NULL
ResponseId<-NULL
GENDER<-NULL
CLASS_YR<-NULL
MAJOR<-NULL
current_donor_status<-NULL
DNR_GIVING<-NULL
DNR_TOTAL_YEARS<-NULL
first_gift<-NULL
last_gift<-NULL
last_gift_amount<-NULL
last_gift_for<-NULL
donations<-NULL
d<-NULL
donations1<-NULL
split<-NULL
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
donations2<-NULL
donatoins2<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
lbw.for.lm1<-na.omit(lbw.for.lm1)
xtest<-model.matrix(y~.,lbw.for.lm1)[,-1]
ytest<-lbw.for.lm1$y
yhat<-predict(cv.out,s=lambda_min,newx=xtest)
mse<-mean((ytest-yhat)^2)
mse
stargazer(best.model.lm5, best.model.lm2,best.model.lm3,best.model.lm4,best.model.lm1, type="latex",
dep.var.labels=c("Log(Donations)")
)
stargazer(best.model.lm5, best.model.lm2,best.model.lm3,best.model.lm4,best.model.lm1, type="latex",
dep.var.labels=c("Log(Donations)"),
covariate.labels=c("Rho","Trust2", "Ultimatum1", "PGG",
"SRA1", "SRA2", "SRA4", "SRA5", "SRA6"))
model1<-lm(donations~alpha, data=data)
model2<-lm(donations~rho, data=data)
model3<-lm(donations~UG1, data=data)
model4<-lm(donations~UG2, data=data)
model5<-lm(donations~TG1, data=data)
model6<-lm(donations~TG2, data=data)
model7<-lm(donations~PGG, data=data)
model8<-lm(donations~alpha+rho+UG1+UG2+TG1+TG2+PGG, data=data)
model9<- lm(donations~SRAtotal, data=data)
model10<-lm(donations~SRAmoney, data=data)
model11 <- lm(donations ~ alpha +rho+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal, data=data)
model12 <- lm(donations ~ alpha +rho+ UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney, data=data)
stargazer(model1, model2, model3, model4, model5, model6,model7,model8,model9, model10, model11,model12,type="latex",
dep.var.labels=c("Donations"),
covariate.labels=c("Alpha", "Rho","UG1", "UG2", "TG1",
"Reciprocity", "PGG", "SRAtotal", "SRAmoney"))
model12<-glm(donated~alpha, data=data)
pR2(model12)
model13<-glm(donated~rho,data=data)
pR2(model13)
model14<-glm(donated~UG1, data=data)
pR2(model14)
model15<-glm(donated~UG2, data=data)
pR2(model15)
model16<-glm(donated~TG1, data=data)
pR2(model16)
model17<-glm(donated~TG2, data=data)
pR2(model17)
model18<-glm(donated~PGG, data=data)
pR2(model18)
model19<-glm(donated~alpha+rho+UG1+UG2+TG1+TG2+PGG, data=data)
pR2(model19)
model20<- glm(donated~SRAtotal, data=data)
pR2(model20)
model21<-glm(donated~SRAmoney, data=data)
pR2(model21)
model22 <- glm(donated ~ alpha +rho+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal, data=data)
pR2(model22)
model23 <- glm(donated ~ alpha+rho + UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney, data=data)
pR2(model23)
summary(model19)
stargazer(model12, model13, model14, model15, model16, model17,model18,model19,model20,model21,model22,model23, type="latex",
dep.var.labels=c("Donated"),
covariate.labels=c("Alpha", "Rho","UG1", "UG2", "TG1",
"Reciprocity", "PGG","SRAtotal", "SRAmoney"))
stargazer(model19, model20, model21, model22,type="latex",
dep.var.labels=c("Donated"),
covariate.labels=c("Alpha", "UG1", "UG2", "TG1",
"Reciprocity", "PGG", "SRAtotal", "SRAmoney"))
pR2(model22)
mse1 <- mean(model1$residuals^2)
mse2 <- mean(model2$residuals^2)
mse3 <- mean(model3$residuals^2)
mse4 <- mean(model4$residuals^2)
mse5 <- mean(model5$residuals^2)
mse6<-mean(model6$residuals^2)
mse7<-mean(model7$residuals^2)
mse8<-mean(model8$residuals^2)
mse9<-mean(model9$residuals^2)
mse10<-mean(model10$residuals^2)
mse11<-mean(model11$residuals^2)
mse12<-mean(model12$residuals^2)
mse13<-mean(model13$residuals^2)
mse14<-mean(model14$residuals^2)
mse15<-mean(model15$residuals^2)
mse16<-mean(model16$residuals^2)
mse17<-mean(model17$residuals^2)
mse18<-mean(model18$residuals^2)
mse19<-mean(model19$residuals^2)
mse20<-mean(model20$residuals^2)
mse21<-mean(model21$residuals^2)
mse22<-mean(model22$residuals^2)
#Best subset model selection with R
View(data)
data1<-data[,c("donations", "alpha","rho", "sigma", "UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRA1", "SRA2","SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10",
"SRAtotal", "SRAmoney")]
data2<-data[,c("donations", "alpha","UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRA1", "SRA2","SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10",
"SRAtotal", "SRAmoney")]
data3<-data[,c("donations", "alpha","UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRAtotal", "SRAmoney")]
data4<-data[,c("donated", "alpha","UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRAtotal", "SRAmoney")]
data5<-data[,c("donated", "alpha","rho", "sigma", "UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRA1", "SRA2","SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10",
"SRAtotal", "SRAmoney")]
library(bestglm)
lbw.for.logistic<-within(data5, {
y<-donated
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
View(data5)
View(data5)
View(data5)
lbw.for.logistic<-within(data5, {
y<-donated
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
res.bestglm<-
bestglm(Xy=lbw.for.logistic,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
best.model.log1<-glm(donated~SRA3+SRA4+SRA8+SRA10,data=data)
best.model.log1<-glm(donated~SRA3+SRA4+SRA8+SRA10,data=data)
best.model.log2<-glm(donated~SRA3+SRA4+SRA7+SRA8+SRA10,data=data)
best.model.log3<-glm(donated~alpha+SRA3+SRA4+SRA8+SRA10,data=data)
best.model.log4<-glm(donated~alpha+SRA3+SRA4+SRA7+SRA8+SRA10,data=data)
best.model.log5<-glm(donated~UG2+SRA3+SRA4+SRA8+SRA10,data=data)
library(pscl)
pR2(best.model.log1)
pR2(best.model.log2)
pR2(best.model.log3)
pR2(best.model.log4)
pR2(best.model.log5)
stargazer(best.model.log1, best.model.log2, best.model.log3, best.model.log4,
best.model.log5, type="latex",
dep.var.labels=c("Donated")
)
stargazer(best.model.log3, best.model.log4, best.model.log5, best.model.log1,
best.model.log2, type="latex",
dep.var.labels=c("Donated"),
)
stargazer(best.model.log3, best.model.log4, best.model.log5, best.model.log1,
best.model.log2, type="latex",
dep.var.labels=c("Donated"))
stargazer(best.model.log3, best.model.log4, best.model.log5, best.model.log1,
best.model.log2, type="latex",
dep.var.labels=c("Donated"),
covariate.labels=c("alpha", "UG2", "SRA3", "SRA4", "SRA8", "SRA10"))
pR2(best.model.log1)
pR2(best.model.log3)
pR2(best.model.log4)
pR2(best.model.log5)
pR2(best.model.log1)
pR2(best.model.log2)
lbw.for.glm<-within(data1, {
y<-donations
sigma<-NULL
donations<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
lbw.for.glm<-na.omit(lbw.for.glm)
res.best.glm<-
bestglm(Xy=lbw.for.glm,
family=gaussian,
IC="AIC",
method="exhaustive")
summary(lbw.for.glm$y)
res.best.glm$BestModels
best.model.lm1<-lm(donations~UG1+TG2+SRA3+SRA4+SRA5+SRA6, data=data)
best.model.lm2<-lm(donations~UG1+UG2+TG2+SRA3+SRA4+SRA5+SRA6, data=data)
best.model.lm3<-lm(donations~UG1+TG2+SRA1+SRA3+SRA4+SRA5+SRA6, data=data)
best.model.lm4<-lm(donations~UG1+TG2+PGG+SRA3+SRA4+SRA5+SRA6, data=data)
best.model.lm5<-lm(donations~UG1+TG1+TG2+PGG+SRA3+SRA4+SRA5+SRA6, data=data)
stargazer(best.model.lm5, best.model.lm4, best.model.lm2, best.model.lm1,
best.model.lm3,type="latex",
dep.var.labels=c("Log(Donations)")
)
stargazer(best.model.lm2, best.model.lm4, best.model.lm5, best.model.lm1,
best.model.lm3,type="latex",
dep.var.labels=c("Log(Donations)"))
summary(censReg(donations~rho, data=data, left=0, right=50))
best.model.lm1<-lm(donations~UG1+TG2+SRA3+SRA4+SRA5+SRA6, data=data)
best.model.lm2<-lm(donations~UG1+UG2+TG2+SRA3+SRA4+SRA5+SRA6, data=data)
best.model.lm3<-lm(donations~UG1+TG2+SRA1+SRA3+SRA4+SRA5+SRA6, data=data)
best.model.lm4<-lm(donations~UG1+TG2+PGG+SRA3+SRA4+SRA5+SRA6, data=data)
best.model.lm5<-lm(donations~UG1+TG1+TG2+PGG+SRA3+SRA4+SRA5+SRA6, data=data)
stargazer(best.model.lm2, best.model.lm4, best.model.lm5, best.model.lm1,
best.model.lm3,type="latex",
dep.var.labels=c("Log(Donations)"),
covariate.labels=c("UG1","UG2", "TG1", "TG2","SRA1", "SRA3", "SRA4", "SRA5", "SRA6"))
stargazer(best.model.lm2, best.model.lm4, best.model.lm5, best.model.lm1,
best.model.lm3,type="latex",
dep.var.labels=c("Log(Donations)"),
covariate.labels=c("UG1","UG2", "TG1", "TG2","PGG", "SRA1", "SRA3", "SRA4", "SRA5", "SRA6"))
stargazer(best.model.log3, best.model.log4, best.model.log5, best.model.log1,
best.model.log2, type="latex",
dep.var.labels=c("Donated")
)
