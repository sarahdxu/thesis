res.bestglm$BestModels
lbw.for.logistic<-within(data5, {
y<-donated
sigma<-NULL
donated<-NULL
#SRAtotal<-NULL
#SRAmoney<-NULL
SRA1<-NULL
SRA2<-NULL
SRA3<-NULL
SRA4<-NULL
SRA5<-NULL
SRA6<-NULL
SRA7<-NULL
SRA8<-NULL
SRA9<-NULL
SRA10<-NULL
})
res.bestglm<-
bestglm(Xy=lbw.for.logistic,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
lbw.for.logistic<-within(data5, {
y<-donated
sigma<-NULL
donated<-NULL
#SRAtotal<-NULL
SRAmoney<-NULL
SRA1<-NULL
SRA2<-NULL
SRA3<-NULL
SRA4<-NULL
SRA5<-NULL
SRA6<-NULL
SRA7<-NULL
SRA8<-NULL
SRA9<-NULL
SRA10<-NULL
})
res.bestglm<-
bestglm(Xy=lbw.for.logistic,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
lbw.for.logistic<-within(data5, {
y<-donated
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
SRA1<-NULL
SRA2<-NULL
SRA3<-NULL
SRA4<-NULL
SRA5<-NULL
SRA6<-NULL
SRA7<-NULL
SRA8<-NULL
SRA9<-NULL
SRA10<-NULL
})
res.bestglm<-
bestglm(Xy=lbw.for.logistic,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
lbw.for.logistic<-within(data5, {
y<-donated
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
res.bestglm<-
bestglm(Xy=lbw.for.logistic,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
lbw.for.logistic<-within(data5, {
y<-donated
sigma<-NULL
donated<-NULL
#   SRAtotal<-NULL
#   SRAmoney<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
res.bestglm<-
bestglm(Xy=lbw.for.logistic,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
lbw.for.glm<-within(data1, {
y<-donations
sigma<-NULL
donations<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
res.best.glm<-
bestglm(Xy=lbw.for.glm,
family=gaussian,
IC="AIC",
method="exhaustive")
res.best.glm$BestModels
regsubsets.out<-regsubsets(donations~alpha+rho+UG1+UG2+TG1+TG2+avgreturn+PGG+
SRA1+SRA2+SRA3+SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,#+
#SRAtotal+SRAmoney,
data=data,
nbest=1,
nvmax=NULL,
force.in=NULL, force.out=NULL,
method="exhaustive")
summary.out<-summary(regsubsets.out)
as.data.frame(summary.out$outmat)
which.max(summary.out$adjr2)
summary.out$which[6,]
best.model<-lm(donations~rho+SRA3+SRA4+SRA5+SRA6+SRA10,data=data)
best.model<-vglm(donations~rho+SRA3+SRA4+SRA5+SRA6+SRA10,data=data,
tobit(Lower=0,Upper=50))
summary(best.model)
res.bestglm$BestModels
best.model.log<-glm(donated~SRA3+SRA4+SRA8+SRA10,data=data)
summary(best.model.log)
stargazer(best.model.log, type="latex",
dep.var.labels=c("Donated"),
covariate.labels=c("SRA3", "SRA4", "SRA8", "SRA10"))
best.model<-vglm(donations~rho+SRA3+SRA4+SRA5+SRA6+SRA10,data=data,
tobit(Lower=0,Upper=50))
stargazer(best.model,type="latex",
dep.var.labels=c("Donations"),
covariate.labels=c("Rho", "SRA3", "SRA4", "SRA5",
"SRA6", "SRA10"))
best.model<-lm(donations~rho+SRA3+SRA4+SRA5+SRA6+SRA10,data=data)
stargazer(best.model,type="latex",
dep.var.labels=c("Donations"),
covariate.labels=c("Rho", "SRA3", "SRA4", "SRA5",
"SRA6", "SRA10"))
best.model<-vglm(donations~rho+SRA3+SRA4+SRA5+SRA6+SRA10,data=data,
tobit(Lower=0,Upper=50))
best.model
censReg(donations ~ alpha + UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal, data=data, left=0, right=50)
modela<-tobit(donations ~ alpha + UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal, data=data, left=0, right=50)
summary(m<-vglm(donations~alpha+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal,
tobit(Lower=0,Upper=50),data=dat))
best.model<-vglm(donations~rho+SRA3+SRA4+SRA5+SRA6+SRA10,data=data,
tobit(Lower=0,Upper=50))
summary(best.model)
stargazer(best.model,type="latex",
dep.var.labels=c("Donations"),
covariate.labels=c("Rho", "SRA3", "SRA4", "SRA5",
"SRA6", "SRA10"))
stargazer(best.model.log, type="latex",
dep.var.labels=c("Donated"),
covariate.labels=c("SRA3", "SRA4", "SRA8", "SRA10"))
pseudoR2(best.model.log)
pR2(best.model.log)
dat<-data[,c("donations", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
null=lm(donations~1, data=dat)
null
full=lm(donations~., data=dat)
full
step(null,scope=list(lower=null,upper=full),
direction="forward")
step(null,scope=list(upper=full),data=dat,
direction="both")
xfacors<-model.matrix(donated~alpha+rho+UG1+UG2+
TG2+TG2+avgreturn+PGG+SRA1+SRA2+SRA3+
SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10)[,-1]
dat<-data[,c("donated", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
xfacors<-model.matrix(donated~alpha+rho+UG1+UG2+
TG2+TG2+avgreturn+PGG+SRA1+SRA2+SRA3+
SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat)[,-1]
xfactors<-model.matrix(donated~alpha+rho+UG1+UG2+
TG2+TG2+avgreturn+PGG+SRA1+SRA2+SRA3+
SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat)[,-1]
xfactors
x<-as.matrix(xfactors)
glmmod<-glmnet(x,y=as.factor(donated), alpha=1, family="binomial")
glmmod<-glmnet(x,y=as.factor(donated), data=dat,alpha=1, family="binomial")
y<-dat$donated
glmmod<-glmnet(x,y,alpha=1, family="binomial")
y<-as.factor(dat$donated)
glmmod<-glmnet(x,y,alpha=1, family="binomial")
plot(glmmod,xvar="lambda")
glmmod
coef(glmmod)[,10]
coef(glmmod)[,1]
cv.glmmod<-cv.glmnet(x,y,alpha=1)
y<-dat$donated
glmmod<-glmnet(x,y,alpha=1, family="binomial")
plot(glmmod,xvar="lambda")
glmmod
cv.glmmod<-cv.glmnet(x,y,alpha=1)
plot(cv.glmmod)
(best.lambda<-cv.glmmod$lambda.min)
glmmod<-glmnet(x,y,alpha=1, family="binomial", type.measure="mse")
cv.out<-cv.glmnet(x,y,alpha=1, family="binomial", type.measure="mse")
plot(cv.out)
plot(cv.out)
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_1se)
lambda_min
lambda_1se
coef(cv.out,s=lambda_min)
dat<-data[,c("donated", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
xfactors<-model.matrix(donated~alpha+rho+UG1+UG2+
TG2+TG2+avgreturn+PGG+SRA1+SRA2+SRA3+
SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat)[,-1]
y<-dat$donated
x<-as.matrix(xfactors)
cv.out<-cv.glmnet(x,y,alpha=1, family="binomial", type.measure="mse")
plot(cv.out)
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_1se)
coef(cv.out,s=lambda_min)
dat<-data[,c("donations", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
xfactors<-model.matrix(donations~alpha+rho+UG1+UG2+
TG2+TG2+avgreturn+PGG+SRA1+SRA2+SRA3+
SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat)[,-1]
y<-dat$donations
x<-as.matrix(xfactors)
cv.out<-cv.glmnet(x,y,alpha=1, type.measure="mse")
plot(cv.out)
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_1se)
coef(cv.out,s=lambda_min)
cv.out<-cv.glmnet(x,y,alpha=1, family="gaussian",type.measure="mse")
plot(cv.out)
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
lambda_min
lambda_1se
coef(cv.out,s=lambda_1se)
coef(cv.out,s=lambda_min)
dat<-data[,c("donated", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
null=glm(donations~1, data=dat)
null=glm(donated~1, data=dat)
null
full=glm(donated~., data=dat)
step(null,scope=list(upper=full),data=dat,
direction="both")
dat<-data[,c("donations", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
View(dat)
null=lm(donations~1, data=dat)
full=lm(donations~., data=dat)
step(null,scope=list(upper=full),data=dat,
direction="both")
dat<-data[,c("donations", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10",
"SRAtotal", "SRAmoney")]
null=lm(donations~1, data=dat)
null
full=lm(donations~., data=dat)
full
step(null,scope=list(upper=full),data=dat,
direction="both")
dat<-data[,c("donations", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
null=lm(donations~1, data=dat)
full=lm(donations~., data=dat)
step(null,scope=list(upper=full),data=dat,
direction="both")
null=vglm(donations~1, data=dat, tobit(Lower=0, Upper=50))
full=lm(donations~., data=dat, tobit(Lower=0, Upper=50))
full=lm(donations~alpha+rho+UG1+UG2+TG1+TG2+avgreturn+PGG+
SRA1+SRA2+SRA3+SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat, tobit(Lower=0, Upper=50))
full=vglm(donations~alpha+rho+UG1+UG2+TG1+TG2+avgreturn+PGG+
SRA1+SRA2+SRA3+SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat, tobit(Lower=0, Upper=50))
full=vglm(donations~.,data=dat,tobit(Lower=0,Upper=50))
step(null,scope=list(upper=full),data=dat,
direction="both")
lbw.for.glm<-within(data1, {
y<-donations
sigma<-NULL
donations<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
})
res.best.glm<-
bestglm(Xy=lbw.for.glm,
family=gaussian,
IC="AIC",
method="exhaustive")
res.best.glm$BestModels
lbw.for.logistic<-within(data5, {
y<-donated
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
})
res.bestglm<-
bestglm(Xy=lbw.for.logistic,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
best.model.log<-glm(donated~SRA3+SRA4+SRA8+SRA10,data=data)
summary(best.model.log)
best.subset<-regsubsets(donated~.,lbw.for.logistic,nvmax=5)
lbw.for.logistic
best.subset<-regsubsets(donated~.,data5,nvmax=5)
best.subset<-regsubsets(y~.,lbw.for.logistic,nvmax=5)
best.subset.summary<-summary(best.subset)
best.subset.summary$outmat
best.subset<-regsubsets(y~.,lbw.for.logistic)
best.subset.summary<-summary(best.subset)
best.subset.summary$outmat
best.subset.by.cp<-which.min(best.subset.summary&cp)
best.subset.by.cp<-which.min(best.subset.summary$cp)
best.subset.by.cp
best.subset<-regsubsets(y~.,lbw.for.glm)
best.subset.summary<-summary(best.subset)
best.subset.summary$outmat
best.subset.by.cp<-which.min(best.subset.summary$cp)
best.subset.by.cp
lbw.for.glm<-within(data1, {
y<-donations
sigma<-NULL
donations<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
res.best.glm<-
bestglm(Xy=lbw.for.glm,
family=gaussian,
IC="AIC",
method="exhaustive")
res.best.glm$BestModels
best.model.lm<-vglm(donations~rho,data=data, tobit(Lower=0,Upper=50))
stargazer(best.model.lm, type="latex",
dep.var.labels=c("Donations"),
covariate.labels=c("Rho"))
best.model.lm<-vglm(donations~rho,data=data, tobit(Lower=0,Upper=50))
summary(best.model.lm)
m<-lm(donaions~rho,data=data)
m<-lm(donations~rho,data=data)
stargazer(m, type="latex",
dep.var.labels=c("Donations"),
covariate.labels=c("Rho"))
best.model.lm<-vglm(donations~rho,data=data, tobit(Lower=0,Upper=100))
summary(best.m)
summary(best.model.lm)
best.model.lm<-vglm(donations~rho+SRA5,data=data, tobit(Lower=0,Upper=100))
summary(best.model.lm)
best.model.lm<-vglm(donations~rho,data=data, tobit(Lower=0,Upper=50))
summary(best.model.lm)
dat<-data[,c("donations", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
nu
dat<-data[,c("donations", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
null=lm(donations~1, data=dat)
full=lm(donations~.,data=dat)
step(null,scope=list(upper=full),data=dat,
direction="both")
vglm(donations~rho,data=data,
tobit(Lower=0,Upper=50))
tobit(Lower=0,Upper=50)))
summary(vglm(donations~rho,data=data,
tobit(Lower=0,Upper=50)))
censReg(donations~rho, data=dat, left=0, right=50)
summary(censReg(donations~rho, data=dat, left=0, right=50))
dat<-data[,c("donated", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
xfactors<-model.matrix(donated~alpha+rho+UG1+UG2+
TG2+TG2+avgreturn+PGG+SRA1+SRA2+SRA3+
SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat)[,-1]
y<-dat$donated
x<-as.matrix(xfactors)
cv.out<-cv.glmnet(x,y,alpha=1, family="binomial", type.measure="mse")
plot(cv.out)
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_1se)
coef(cv.out,s=lambda_min)
dat<-data[,c("donations", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
xfactors<-model.matrix(donations~alpha+rho+UG1+UG2+
TG2+TG2+avgreturn+PGG+SRA1+SRA2+SRA3+
SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat)[,-1]
y<-dat$donations
x<-as.matrix(xfactors)
cv.out<-cv.glmnet(x,y,alpha=1, family="gaussian",type.measure="mse")
plot(cv.out)
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_1se)
coef(cv.out,s=lambda_min)
from sklearn.linear_model import Lasso
install.packages("lars")
library(lars)
dat<-data[,c("donations", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
xfactors<-model.matrix(donations~alpha+rho+UG1+UG2+
TG2+TG2+avgreturn+PGG+SRA1+SRA2+SRA3+
SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat)[,-1]
y<-dat$donations
x<-as.matrix(xfactors)
lars(x,y,type="lasso")
lasso<-lars(x,y,type="lasso")
lasso$lambda
summary(lasso)
lasso$call
lasso$actions
dat<-data[,c("donated", "alpha", "rho", "UG1", "UG2",
"TG1", "TG2", "avgreturn", "PGG", "SRA1", "SRA2",
"SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10")]
xfactors<-model.matrix(donated~alpha+rho+UG1+UG2+
TG2+TG2+avgreturn+PGG+SRA1+SRA2+SRA3+
SRA4+SRA5+SRA6+SRA7+SRA8+SRA9+SRA10,
data=dat)[,-1]
y<-dat$donated
x<-as.matrix(xfactors)
cv.out<-cv.glmnet(x,y,alpha=1, family="binomial", type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_1se)
coef(cv.out,s=lambda_min)
lambda_min
<-cv.out$lambda.1se
lambda_1se
cv.out<-cv.glmnet(xfactors,y,alpha=1, family="binomial", type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_1se)
coef(cv.out,s=lambda_min)
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_1se)
lasso<-glm(donated~SRA3+SRA4, data=data)
stargazer(lasso, type="latex",
dep.var.labels=c("Donated"),
covariate.labels=c("SRA3," "SRA4"))
stargazer(lasso, type="latex",
dep.var.labels=c("Donated"),
covariate.labels=c("SRA3", "SRA4"))
