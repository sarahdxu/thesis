#control = nls.lm.control(maxiter=75),
data=temp,start=c(A=0,r=1)))[1]
long$r[long$ID==i]<-coef(nlsLM(y~m*(A/((x^r)+A)),
#control = nls.lm.control(maxiter=75),
data=temp,start=c(A=0,r=1)))[2]
}
for (i in long2$ID){
temp<-long[long$ID==i,]
long$A[long$ID==i]<-coef(nlsLM(y~m*(A/((x^r)+A)), data=temp,start=c(A=1,r=1)))[1]
long$r[long$ID==i]<-coef(nlsLM(y~m*(A/((x^r)+A)), data=temp,start=c(A=1,r=1)))[2]
}
# for (i in long2$ID){
#   temp<-long[long$ID==i,]
#   long$A[long$ID==i]<-coef(nlsLM(y~A/((x^r))+A, data=temp,start=c(A=1,r=1)))[1]
#   long$r[long$ID==i]<-coef(nlsLM(y~A/((x^r))+A, data=temp,start=c(A=1,r=1)))[2]
# }
# long1<-long[long$ID!=96 & long$ID!=113 & long$ID!=281,]
# long2<-long[long$ID==96 | long$ID==113 | long$ID==281,]
# for (i in long1$ID){
#   temp<-long[long$ID==i,]
#   long$A[long$ID==i]<-coef(nls(y~A/((x^r)+A), data=temp,
#                                control = nls.control(warnOnly=TRUE),
#                                start=list(A=1, r=-1)))[1]
#   long$r[long$ID==i]<-coef(nls(y~A/((x^r)+A), data=temp,
#                                control=nls.control(warnOnly=TRUE),
#                                start=list(A=1, r=-1)))[2]
# }
#
# for (i in long2$ID){
#   temp<-long[long$ID==i,]
#   long$A[long$ID==i]<-coef(nls(y~A/(x^r+A), data=temp,
#                                control = nls.control(warnOnly=TRUE),
#                                start=list(A=1, r=-10)))[1]
#   long$r[long$ID==i]<-coef(nls(y~A/(x^r+A), data=temp,
#                                control=nls.control(warnOnly=TRUE),
#                                start=list(A=1, r=-10)))[2]
# }
long<-long[,c("ID", "A", "r")]
long<-unique(long)
# long<-long[long$ID!=96 & long$ID!=113 & long$ID!=281 & long$ID!=358,]
long$rho<-long$r/(long$r - 1)
long$alpha<-((long$A)^(1-long$rho))/(1+(long$A)^(1-long$rho))
summary(long$alpha)
summary(long$rho)
long$sigma<-1/(long$rho - 1)
summary(long$sigma)
# long$alpha[long$ID==281]<-0
# long$alpha[long$ID==96]<-0
# long$alpha[long$ID==113]<-0
long<-long[,c("ID", "alpha", "rho", "sigma")]
data1<-merge(long, data, by="ID")
data<-data1[,c("ID", "ResponseId", "alpha", "rho", "sigma",  "TG2", "avgreturn", "UG1", "UG2", "TG1", "PGG", "SRA")]
#####################
#Univariate Analysis#
#####################
#SRA
SRA<-ggplot(data=data, aes(data$SRA))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Total Scores", y="Percent") +
scale_x_continuous(breaks=seq(20,50,2)) + ggtitle("Figure 3: Total SRA Scores")
ggsave("~/Desktop/thesis/paper/images/SRAimg.jpg", width=11, height=8.5)
#UG1
UG1<-ggplot(data=data, aes(data$UG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
ggtitle("Panel C: UG1") +
labs(x="Pass Rate", y="Percent") + ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG1.pdf", width=11, height=8.5)
#UG2
UG2<-ggplot(data=data, aes(data$UG2))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores")
ggtitle("Panel D: UG2")+
labs(x="Minimum Contribution Accepted", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG2.pdf", width=11, height=8.5)
#TG1
TG1<-ggplot(data=data, aes(data$TG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +ylim(c(0,45))+
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel E: TG1")
ggsave("~/Desktop/thesis/output/TG1.pdf", width=11, height=8.5)
#PGG
PGG<-ggplot(data=data, aes(data$PGG))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel F: PGG")
ggsave("~/Desktop/thesis/output/PGG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(UG1, UG2, TG1, PGG, nrow=2)
dev.off()
prop.table(table(data$TG2))
summary(data$TG2)
#TG2 - reciprocity
TG2<-ggplot(data=data, aes(data$TG2)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(-0.5, 1, by=0.1)) +
ylim(c(0,28))+labs(x="Reciprocity", y="Percent") +
ggtitle("Panel G: Reciprocity Levels")
ggsave("~/Desktop/thesis/paper/images/TG2.pdf", width=11, height=8.5)
TG<-ggplot(data=data, aes(data$avgreturn)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
ylim(c(0,28))+labs(x="Repayment Rate", y="Percent") + ggtitle("Panel H: Average Repayment Rate") +
scale_x_continuous(breaks=seq(0, 1, by=0.1))
ggsave("~/Desktop/thesis/paper/images/TG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2c.pdf",width=11,height=8.5)
grid.arrange(TG2, TG, nrow=1)
dev.off()
#donations dataset
donations = read.csv("donations.csv", stringsAsFactors=FALSE)
donations <- donations[-c(11:18, 20:67)]
data <- merge( data,donations, by="ResponseId")
data$donated<-1
data$donated[data$current_donor_status=="Never"]<-0
prop.table(table(data$donated))
donated<-ggplot(data=data, aes(data$donated))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Donated", y="Percent") + scale_x_continuous(breaks=seq(0,1,1)) + ylim(c(0,80))
ggsave("~/Desktop/thesis/paper/images/donated.pdf", width=11, height=8.5)
data$donations<-as.numeric(data$DNR_GIVING)
d<-data[data$donation<=625,]
donations<-ggplot(data=d, aes(d$donation))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=10)+
labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,650,50))+ylim(c(0,60))
ggsave("~/Desktop/thesis/paper/images/donations.pdf", width=11, height=8.5)
e<-data[data$donation>625,]
prop.table(table(e$donation))
summary(data$donation)
#GDG
alpha<-ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggsave("~/Desktop/thesis/paper/images/alpha.pdf", width=11, height=8.5)
data1<-data[data$rho<=1 & data$rho>=-1,]
summary(data$rho[data$rho<(-1)])
prop.table(table(data$rho[data$rho<(-1)]))
data2<-data[data$rho<(-1),]
69+224
data2$rho1<-(-1.25)
data2$rho1
data$rho1<-data$rho
data$rho1[data$rho1<(-1),]<-(-1.25)
data$rho1[data$rho1<(-1)]<-(-1.25)
data$rho1[data$rho1>1]<-NA
ggplot(data=data) +
geom_histogram(aes(x=rho1[rho1>=-1], y=100*(..count..)/sum(..count..)), binwidth=0.05)+
geom_histogram(aes(x=rho1[rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
#scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
data1<-data[data$rho<=1,]
data1$rho1<-data1$rho
data1$rho1[data1$rho1<(-1)]<-(-1.25)
rho<-ggplot(data=data1) +
geom_histogram(aes(x=rho1[rho1>=-1], y=100*(..count..)/sum(..count..)), binwidth=0.05)+
geom_histogram(aes(x=rho1[rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
#scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
rho
rho<-ggplot(data=data1, aes(x=data1$rho1)) +
geom_histogram(aes(x=data1$rho1[data1$rho1>=-1], y=100*(..count..)/sum(..count..)), binwidth=0.05)+
geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
#scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
rho
ggplot(data=data1, aes(x=data1$rho1)) +
geom_histogram(aes(x=data1$rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
#scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
data2<-data[data$rho>1,]
View(data2)
rho<-ggplot(data=data1, aes(x=data1$rho1)) +
geom_histogram(aes(x=data1$rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
#scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
data2<-data[data$rho<=1 & data$rho>=-1,]
data2<-data[data$rho<=1,]
plot(data2$rho, data2$alpha)
data2<-data[data$rho<=1 & data$rho>=-1,]
plot(data2$rho, data2$alpha)
fig<-ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=0.5)
fig
plot(data2$rho, data2$alpha)
fig<-ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=1)
fig
fig<-ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=5)
fig
ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=2)
fig<-ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=2, color="blue")
fig
ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=2, color="gray")
ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=2, color="dark gray")
fig<-ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=2)
fig
rho
rho<-ggplot(data=data1, aes(x=data1$rho1)) +
geom_histogram(aes(x=data1$rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
ylim(c(0,25))+
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
rho
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(alpha, rho, fig, nrow=1)
dev.off()
SRA<-ggplot(data=data, aes(data$SRA))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Total Scores", y="Percent") +
scale_x_continuous(breaks=seq(20,50,2)) + ggtitle("Figure 3: Total SRA Scores")
ggsave("~/Desktop/thesis/paper/images/SRAimg.jpg", width=11, height=8.5)
#UG1
UG1<-ggplot(data=data, aes(data$UG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
ggtitle("Panel D: UG1") +
labs(x="Pass Rate", y="Percent") + ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG1.pdf", width=11, height=8.5)
#UG2
UG2<-ggplot(data=data, aes(data$UG2))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores")
ggtitle("Panel E: UG2")+
labs(x="Minimum Contribution Accepted", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG2.pdf", width=11, height=8.5)
#TG1
TG1<-ggplot(data=data, aes(data$TG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +ylim(c(0,45))+
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel F: TG1")
ggsave("~/Desktop/thesis/output/TG1.pdf", width=11, height=8.5)
#PGG
PGG<-ggplot(data=data, aes(data$PGG))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel G: PGG")
ggsave("~/Desktop/thesis/output/PGG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(UG1, UG2, TG1, PGG, nrow=2)
dev.off()
prop.table(table(data$TG2))
summary(data$TG2)
#TG2 - reciprocity
TG2<-ggplot(data=data, aes(data$TG2)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(-0.5, 1, by=0.1)) +
ylim(c(0,28))+labs(x="Reciprocity", y="Percent") +
ggtitle("Panel H: Reciprocity Levels")
ggsave("~/Desktop/thesis/paper/images/TG2.pdf", width=11, height=8.5)
TG<-ggplot(data=data, aes(data$avgreturn)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
ylim(c(0,28))+labs(x="Repayment Rate", y="Percent") + ggtitle("Panel I: Average Repayment Rate") +
scale_x_continuous(breaks=seq(0, 1, by=0.1))
ggsave("~/Desktop/thesis/paper/images/TG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2c.pdf",width=11,height=8.5)
grid.arrange(TG2, TG, nrow=1)
dev.off()
#donations dataset
donations = read.csv("donations.csv", stringsAsFactors=FALSE)
donations <- donations[-c(11:18, 20:67)]
data <- merge( data,donations, by="ResponseId")
data$donated<-1
data$donated[data$current_donor_status=="Never"]<-0
prop.table(table(data$donated))
donated<-ggplot(data=data, aes(data$donated))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Donated", y="Percent") + scale_x_continuous(breaks=seq(0,1,1)) + ylim(c(0,80))
ggsave("~/Desktop/thesis/paper/images/donated.pdf", width=11, height=8.5)
data$donations<-as.numeric(data$DNR_GIVING)
d<-data[data$donation<=625,]
donations<-ggplot(data=d, aes(d$donation))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=10)+
labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,650,50))+ylim(c(0,60))
ggsave("~/Desktop/thesis/paper/images/donations.pdf", width=11, height=8.5)
e<-data[data$donation>625,]
prop.table(table(e$donation))
summary(data$donation)
#GDG
alpha<-ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggsave("~/Desktop/thesis/paper/images/alpha.pdf", width=11, height=8.5)
data1<-data[data$rho<=1 & data$rho>=-1,]
data2<-data[data$rho<(-1),]
data2$rho1<-(-1.25)
data$rho1[data$rho1>1]<-NA
data1<-data[data$rho<=1,]
data1$rho1<-data1$rho
data1$rho1[data1$rho1<(-1)]<-(-1.25)
data2<-data[data$rho>1,]
rho<-ggplot(data=data1, aes(x=data1$rho1)) +
geom_histogram(aes(x=data1$rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
ylim(c(0,25))+
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
data2<-data[data$rho<=1 & data$rho>=-1,]
plot(data2$rho, data2$alpha)
fig<-ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=2) + labs(x="Rho", y="Alpha") +
ggtitle("Panel C: Scatterplot of CES Parameters")
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(alpha, rho, fig, nrow=1)
dev.off()
donations <- donations[-c(11:18, 20:67)]
data <- merge( data,donations, by="ResponseId")
donations = read.csv("donations.csv", stringsAsFactors=FALSE)
donations <- donations[-c(11:18, 20:67)]
data <- merge( data,donations, by="ResponseId")
data$donated<-1
data$donated[data$current_donor_status=="Never"]<-0
prop.table(table(data$donated))
donated<-ggplot(data=data, aes(data$donated))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Donated", y="Percent") + scale_x_continuous(breaks=seq(0,1,1)) + ylim(c(0,80))
ggsave("~/Desktop/thesis/paper/images/donated.pdf", width=11, height=8.5)
data$donations<-as.numeric(data$DNR_GIVING)
d<-data[data$donation<=625,]
donations<-ggplot(data=d, aes(d$donation))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=10)+
labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,650,50))+ylim(c(0,60))
ggsave("~/Desktop/thesis/paper/images/donations.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2b.pdf",width=11,height=8.5)
grid.arrange(UG1, UG2, TG1, PGG, nrow=2)
dev.off()
donated<-ggplot(data=data, aes(data$donated))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Donated", y="Percent") + scale_x_continuous(breaks=seq(0,1,1)) + ylim(c(0,80))+
ggtitle("Donations")
ggsave("~/Desktop/thesis/paper/images/donated.pdf", width=11, height=8.5)
data$donations<-as.numeric(data$DNR_GIVING)
d<-data[data$donation<=625,]
donations<-ggplot(data=d, aes(d$donation))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=10)+
labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,650,50))+ylim(c(0,60))+
ggtitle("Panel K: Average Donation Amount")
ggsave("~/Desktop/thesis/paper/images/donations.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure4.pdf",width=11,height=8.5)
grid.arrange(donated, donations, nrow=1)
dev.off()
grid.arrange(donated, donations, nrow=1)
grid.arrange(alpha, rho, fig, nrow=1)
#SRA
SRA<-ggplot(data=data, aes(data$SRA))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Total Scores", y="Percent") +
scale_x_continuous(breaks=seq(20,50,2)) + ggtitle("Figure 3: Total SRA Scores")
ggsave("~/Desktop/thesis/paper/images/SRAimg.jpg", width=11, height=8.5)
#UG1
UG1<-ggplot(data=data, aes(data$UG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
ggtitle("Panel C: UG1") +
labs(x="Pass Rate", y="Percent") + ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG1.pdf", width=11, height=8.5)
#UG2
UG2<-ggplot(data=data, aes(data$UG2))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores")
ggtitle("Panel D: UG2")+
labs(x="Minimum Contribution Accepted", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG2.pdf", width=11, height=8.5)
#TG1
TG1<-ggplot(data=data, aes(data$TG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +ylim(c(0,45))+
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel E: TG1")
ggsave("~/Desktop/thesis/output/TG1.pdf", width=11, height=8.5)
#PGG
PGG<-ggplot(data=data, aes(data$PGG))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel F: PGG")
ggsave("~/Desktop/thesis/output/PGG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2b.pdf",width=11,height=8.5)
grid.arrange(UG1, UG2, TG1, PGG, nrow=2)
dev.off()
prop.table(table(data$TG2))
summary(data$TG2)
#TG2 - reciprocity
TG2<-ggplot(data=data, aes(data$TG2)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(-0.5, 1, by=0.1)) +
ylim(c(0,28))+labs(x="Reciprocity", y="Percent") +
ggtitle("Panel G: Reciprocity Levels")
ggsave("~/Desktop/thesis/paper/images/TG2.pdf", width=11, height=8.5)
TG<-ggplot(data=data, aes(data$avgreturn)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
ylim(c(0,28))+labs(x="Repayment Rate", y="Percent") + ggtitle("Panel H: Average Repayment Rate") +
scale_x_continuous(breaks=seq(0, 1, by=0.1))
ggsave("~/Desktop/thesis/paper/images/TG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2c.pdf",width=11,height=8.5)
grid.arrange(TG2, TG, nrow=1)
dev.off()
#donations dataset
donations = read.csv("donations.csv", stringsAsFactors=FALSE)
donations <- donations[-c(11:18, 20:67)]
data <- merge( data,donations, by="ResponseId")
data$donated<-1
data$donated[data$current_donor_status=="Never"]<-0
prop.table(table(data$donated))
donated<-ggplot(data=data, aes(data$donated))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Donated", y="Percent") + scale_x_continuous(breaks=seq(0,1,1)) + ylim(c(0,80))+
ggtitle("Panel I: Donations")
ggsave("~/Desktop/thesis/paper/images/donated.pdf", width=11, height=8.5)
data$donations<-as.numeric(data$DNR_GIVING)
d<-data[data$donation<=625,]
donations<-ggplot(data=d, aes(d$donation))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=10)+
labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,650,50))+ylim(c(0,60))+
ggtitle("Panel J: Average Donation Amount")
ggsave("~/Desktop/thesis/paper/images/donations.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure4.pdf",width=11,height=8.5)
grid.arrange(donated, donations, nrow=1)
dev.off()
e<-data[data$donation>625,]
prop.table(table(e$donation))
summary(data$donation)
#GDG
alpha<-ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggsave("~/Desktop/thesis/paper/images/alpha.pdf", width=11, height=8.5)
data1<-data[data$rho<=1 & data$rho>=-1,]
data2<-data[data$rho<(-1),]
data2$rho1<-(-1.25)
data$rho1[data$rho1>1]<-NA
data1<-data[data$rho<=1,]
data1$rho1<-data1$rho
data1$rho1[data1$rho1<(-1)]<-(-1.25)
data2<-data[data$rho>1,]
rho<-ggplot(data=data1, aes(x=data1$rho1)) +
geom_histogram(aes(x=data1$rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
ylim(c(0,25))+
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
data2<-data[data$rho<=1 & data$rho>=-1,]
plot(data2$rho, data2$alpha)
fig<-ggplot(data2, aes(x=rho, y=alpha)) +
geom_point(size=2) + labs(x="Rho", y="Alpha") +
ggtitle("Panel C: Scatterplot of CES Parameters")
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(alpha, rho, nrow=1)
dev.off()
donations = read.csv("donations.csv", stringsAsFactors=FALSE)
donations <- donations[-c(11:18, 20:67)]
data <- merge( data,donations, by="ResponseId")
data$donated<-1
data$donated[data$current_donor_status=="Never"]<-0
prop.table(table(data$donated))
donated<-ggplot(data=data, aes(data$donated))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Donated", y="Percent") + scale_x_continuous(breaks=seq(0,1,1)) + ylim(c(0,80))+
ggtitle("Panel I: Donations")
ggsave("~/Desktop/thesis/paper/images/donated.pdf", width=11, height=8.5)
data$donations<-as.numeric(data$DNR_GIVING)
d<-data[data$donation<=625,]
donations<-ggplot(data=d, aes(d$donation))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=10)+
labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,650,50))+ylim(c(0,60))+
ggtitle("Panel J: Average Donation Amount")
ggsave("~/Desktop/thesis/paper/images/donations.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure4.pdf",width=11,height=8.5)
grid.arrange(donated, donations, nrow=1)
dev.off()
