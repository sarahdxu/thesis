data$p1 <- 1/2
data$p2 <- 1/3
data$p3 <- 2
data$p4 <- 1/2
data$p5 <- 3
data$p6 <- 1
data$p7 <- 2
data$p8 <- 4
data$p9 <- 1/4
data$m1 <- 15
data$m2 <- 10
data$m3 <- 15
data$m4 <- 12
data$m5 <- 10
data$m6 <- 15
data$m7 <- 12
data$m8 <- 10
data$m9 <- 10
data$gendict1<-as.numeric(data$gendict1)
data$gendict2<-as.numeric(data$gendict2)
data$gendict3<-as.numeric(data$gendict3)
data$gendict4<-as.numeric(data$gendict4)
data$gendict5<-as.numeric(data$gendict5)
data$gendict6<-as.numeric(data$gendict6)
data$gendict7<-as.numeric(data$gendict7)
data$gendict8<-as.numeric(data$gendict8)
data$gendict9<-as.numeric(data$gendict9)
data$gendict6[data$ID==281]<-15
data$gendict6[data$ID==65]<-15
data$gendict6[data$ID==96]<-15
data$gendict6[data$ID==108]<-15
data$gendict6[data$ID==154]<-15
data$gendict6[data$ID==358]<-15
data$gendict6[data$ID==16]<-12
data$gendict6[data$ID==81]<-13
data$pi_s1 <- data$m1-data$gendict1
data$pi_s2 <- data$m2-data$gendict2
data$pi_s3 <- data$m3-data$gendict3
data$pi_s4 <- data$m4-data$gendict4
data$pi_s5 <- data$m5-data$gendict5
data$pi_s6 <- data$m6-data$gendict6
data$pi_s7 <- data$m7-data$gendict7
data$pi_s8 <- data$m8-data$gendict8
data$pi_s9 <- data$m9-data$gendict9
data$Y1<-data$pi_s1
data$Y2<-data$pi_s2
data$Y3<-data$pi_s3
data$Y4<-data$pi_s4
data$Y5<-data$pi_s5
data$Y6<-data$pi_s6
data$Y7<-data$pi_s7
data$Y8<-data$pi_s8
data$Y9<-data$pi_s9
data$X1<-data$p1
data$X2<-data$p2
data$X3<-data$p3
data$X4<-data$p4
data$X5<-data$p5
data$X6<-data$p6
data$X7<-data$p7
data$X8<-data$p8
data$X9<-data$p9
gendictlong<-data[,c("ID", "X1", "Y1", "m1", "X2", "Y2", "m2","X3", "Y3", "m3", "X4", "Y4", "m4",
"X5", "Y5", "m5", "X6", "Y6", "m6", "X7", "Y7", "m7", "X8", "Y8", "m8", "X9", "Y9", "m9")]
names(gendictlong)<-c("ID", "g1.x", "g1.y","g1.m", "g2.x", "g2.y", "g2.m","g3.x", "g3.y","g3.m",
"g4.x", "g4.y", "g4.m","g5.x", "g5.y","g5.m", "g6.x", "g6.y","g6.m",
"g7.x", "g7.y", "g7.m","g8.x", "g8.y","g8.m", "g9.x", "g9.y","g9.m")
long<- gendictlong %>%
gather(v, value, g1.x:g9.m) %>%
separate(v, c("var", "col")) %>%
arrange(ID) %>%
spread(col, value)
for (i in long$ID){
temp<-long[long$ID==i,]
model<-nls(y~m*(A/((x^r)+A)), data=temp, start=c(A=1, r=-1),
algorithm="port",
control=nls.control(warnOnly=TRUE),
upper=c(A=Inf, r=0.9999), lower=c(A=-Inf,r=-Inf))
long$A[long$ID==i]<-coef(model)[1]
long$r[long$ID==i]<-coef(model)[2]
}
long<-long[,c("ID", "A", "r")]
long<-unique(long)
long$rho<-long$r/(long$r - 1)
long$alpha<-((long$A)^(1-long$rho))/(1+(long$A)^(1-long$rho))
long$sigma<-1/(long$rho - 1)
long$alpha[long$ID==96]<-0
long$alpha[long$ID==113]<-0
long$alpha[long$ID==281]<-0
long$alpha[long$ID==13]<-1
long$alpha[long$ID==87]<-1
long$alpha[long$ID==362]<-1
long<-long[,c("ID", "alpha", "rho", "sigma")]
data1<-merge(long, data, by="ID")
data<-data1[,c("ID", "ResponseId", "alpha", "rho", "sigma",  "TG2", "avgreturn", "UG1", "UG2", "TG1", "PGG",
"SRA1", "SRA2","SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10",
"SRAtotal", "SRAmoney")]
donations = read.csv("donations.csv", stringsAsFactors=FALSE)
donations <- donations[-c(11:18, 20:67)]
data <- merge( data,donations, by="ResponseId")
data<-data[,c("ID", "ResponseId", "GENDER", "CLASS_YR", "MAJOR", "alpha", "rho",
"sigma", "TG2", "avgreturn", "UG1", "UG2", "TG1", "PGG",
"SRA1", "SRA2","SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10",
"SRAtotal","SRAmoney", "current_donor_status",
"DNR_GIVING", "DNR_TOTAL_YEARS", "first_gift", "last_gift", "last_gift_amount", "last_gift_for")]
# data$UG1<-data$UG1*100
# data$UG2<-data$UG2*100
# data$TG1<-data$TG1*100
# data$PGG<-data$PGG*100
# data$TG2<-data$TG2*100
# data$alpha1<-data$alpha*100
# data$avgreturn<-data$avgreturn*100
#####################
#Univariate Analysis#
#####################
#SRA
SRA<-ggplot(data=data, aes(data$SRAtotal))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Total Scores", y="Percent") +
scale_x_continuous(breaks=seq(20,50,2)) + ggtitle("Panel I: Total SRA Scores")
ggsave("~/Desktop/thesis/paper/images/SRAimg.jpg", width=11, height=8.5)
summary(data$SRAmoney)
SRAmoney<-ggplot(data=data, aes(data$SRAmoney))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="SRA Money Scores", y="Percent") +ggtitle("Panel J: Monetary SRA Scores")+
ggsave("~/Desktop/thesis/paper/images/SRAmoney.jpg", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure3.pdf",width=11,height=8.5)
grid.arrange(SRA, SRAmoney, nrow=2)
dev.off()
#UG1
UG1<-ggplot(data=data, aes(data$UG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
ggtitle("Panel C: Ultimatum Game Proposers") +
labs(x="Pass Rate", y="Percent") + ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG1.pdf", width=11, height=8.5)
#UG2
UG2<-ggplot(data=data, aes(data$UG2))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores")
ggtitle("Panel D: Ultimatum Game Responders")+
labs(x="Minimum Contribution Accepted", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG2.pdf", width=11, height=8.5)
#TG1
TG1<-ggplot(data=data, aes(data$TG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +ylim(c(0,45))+
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel E: Trust Game Proposers")
ggsave("~/Desktop/thesis/output/TG1.pdf", width=11, height=8.5)
#PGG
PGG<-ggplot(data=data, aes(data$PGG))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel F: Public Goods Game")
ggsave("~/Desktop/thesis/output/PGG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2b.pdf",width=11,height=8.5)
grid.arrange(UG1, UG2, TG1, PGG, nrow=2)
dev.off()
#TG2 - reciprocity
TG2<-ggplot(data=data, aes(data$TG2)) +
geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=.05) +
labs(x="Reciprocity", y="Percent") +
ggtitle("Panel G: Reciprocity Levels") +
scale_x_continuous(breaks=seq(-0.5, 1, by=0.1)) + ylim(c(0,28))
ggsave("~/Desktop/thesis/paper/images/TG2.pdf", width=11, height=8.5)
TG<-ggplot(data=data, aes(data$avgreturn)) +
geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
ylim(c(0,28))+labs(x="Repayment Rate", y="Percent") + ggtitle("Panel H: Average Repayment Rate") +
scale_x_continuous(breaks=seq(0, 1, by=0.1))
ggsave("~/Desktop/thesis/paper/images/TG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2c.pdf",width=11,height=8.5)
grid.arrange(TG2, TG, nrow=2)
dev.off()
#donations dataset
data$donated<-1
data$donated[data$current_donor_status=="Never"]<-0
prop.table(table(data$donated))
donated<-ggplot(data=data, aes(data$donated))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +
#  labs(title="Total SRA Scores") +
labs(x="Donated", y="Percent") + scale_x_continuous(breaks=seq(0,1,1)) + ylim(c(0,80))+
ggtitle("Panel K: Donations")
ggsave("~/Desktop/thesis/paper/images/donated.pdf", width=11, height=8.5)
data$donations<-as.numeric(data$DNR_GIVING)
data$d<-data$donations
data$d[data$d>100]<-120
d1<-data[data$donations>100,]
summary(data$donation)
donations<-ggplot(data=data, aes(data$d))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=10)+
labs(x="Donations", y="Percent")+scale_x_continuous(breaks=seq(0,100,10))+
ylim(c(0,60))+
ggtitle("Panel K: Total Donations")
ggsave("~/Desktop/thesis/paper/images/donations.pdf", width=11, height=8.5)
logdonations<-ggplot(data=data, aes(data$donations))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5)+
labs(x="Log(Donations)", y="Percent")+scale_x_continuous(breaks=seq(-6,10,2))+
ggtitle("Panel L: Log of Total Donations")
data$avgdonations<-0
data$avgdonations[data$CLASS_YR=="2018"]<-data$donations1[data$CLASS_YR=="2018"]
data$avgdonations[data$CLASS_YR=="2017"]<-data$donations1[data$CLASS_YR=="2017"]/2
data$avgdonations[data$CLASS_YR=="2016"]<-data$donations1[data$CLASS_YR=="2016"]/3
data$avgdonations[data$CLASS_YR=="2015"]<-data$donations1[data$CLASS_YR=="2015"]/4
data$avgdonations[data$CLASS_YR=="2014"]<-data$donations1[data$CLASS_YR=="2014"]/5
data$avgdonations[data$CLASS_YR=="2013"]<-data$donations1[data$CLASS_YR=="2013"]/6
avgdonations<-ggplot(data=data, aes(data$avgdonations))+geom_histogram(aes(y=100*(..count..)/sum(..count..)))+
labs(x="Average Donations)", y="Percent")+
ggtitle("Panel L: Log of Total Donations")
pdf("~/Desktop/thesis/paper/images/Figure4.pdf",width=11,height=8.5)
grid.arrange(donations, logdonations, nrow=2)
dev.off()
data2018<-data[data$CLASS_YR==2018,]
data2018$donations1[data2018$donations1>=500]<-NA
data2017<-data[data$CLASS_YR==2017,]
data2017$donations1[data2017$donations1>=500]<-NA
data2016<-data[data$CLASS_YR==2016,]
data2016$donations1[data2016$donations1>=400]<-NA
data2015<-data[data$CLASS_YR==2015,]
data2015$donations1[data2015$donations1>=300]<-NA
data2014<-data[data$CLASS_YR==2014,]
data2014$donations1[data2014$donations1>=400]<-NA
data2013<-data[data$CLASS_YR==2013,]
data2013$donations1[data2013$donations1>=2000]<-NA
# install.packages("ggplot2")
# library(ggplot2)
# donations2018<-ggplot(data2018, aes(data2018$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,35,5))+
#   ylim(c(0,100))+
#   ggtitle("2018 Donation Amounts")
#
# donations2017<-ggplot(data2017, aes(data2017$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,40,5))+
#   ylim(c(0,80))+
#   ggtitle("2017 Donation Amounts")
# donations2016<-ggplot(data2016, aes(data2016$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,40,5))+
#   ylim(c(0,35))+
#   ggtitle("2016 Donation Amounts")
#
# donations2015<-ggplot(data2015, aes(data2015$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,90,5))+
#   ylim(c(0,35))+
#   ggtitle("2015 Donation Amounts")
#
# donations2014<-ggplot(data2014, aes(data2014$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,70,5))+
#   ylim(c(0,35))+
#   ggtitle("2014 Donation Amounts")
# data$donations2<-data$donations1
# data$donatoins2[data$donations1>1000]<-NA
# summary(data$donations[data$CLASS_YR==2018])
# summary(data$donations[data$CLASS_YR==2017])
# summary(data$donations[data$CLASS_YR==2016])
# summary(data$donations[data$CLASS_YR==2015])
# summary(data$donations[data$CLASS_YR==2014])
# summary(data$donations[data$CLASS_YR==2013])
summary(data2018$donations1)
summary(data2017$donations1)
summary(data2016$donations1)
summary(data2015$donations1)
summary(data2014$donations1)
summary(data2013$donations1)
summary(data2018$donated)
summary(data2017$donated)
summary(data2016$donated)
summary(data2015$donated)
summary(data2014$donated)
summary(data2013$donated)
df<-data.frame(classyr=c("2018", "2017", "2016", "2015", "2014", "2013"),
avgtotaldonations=c(2.779, 7.276, 11.99, 26.09, 44.02, 68.87),
avgdonations=c(2.779, 3.638, 3.997, 6.52, 8.804, 11.478),
donated=c(0.2857, 0.6316, 0.7231, 0.6875, 0.7143, 0.9074))
avgtotaldonation<-ggplot(df, aes(classyr, avgtotaldonations)) + geom_bar(stat="identity") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Total Donation Amounts")+
ggtitle("Panel N: Average Total Donation Amount by Class Year")
avgdonation<-ggplot(df, aes(classyr, avgdonations)) + geom_bar(stat="identity") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Donation Amounts")+
ggtitle("Panel O: Average Donation Amount by Class Year")
avgdonated<-ggplot(df, aes(classyr, donated)) + geom_bar(stat="identity") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Percent Donated")+
ggtitle("Panel M: Percent Donated by Class Year")
pdf("~/Desktop/thesis/paper/images/Figure6.pdf",width=11,height=8.5)
grid.arrange(avgdonated, avgtotaldonation,avgdonation, nrow=3)
dev.off()
library(gridExtra)
# e<-data[data$donation>625,]
# prop.table(table(e$donation))
# summary(data$donation)
#GDG
alpha<-ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggsave("~/Desktop/thesis/paper/images/alpha.pdf", width=11, height=8.5)
summary(data$UG1)
#data$rho1[data$rho1>1]<-NA
data1<-data
data1$rho1<-data1$rho
data1$rho1[data1$rho1<(-1)]<-(-1.25)
#data2<-data[data$rho>1,]
rho<-ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
# data2<-data[data$rho<=1 & data$rho>=-1,]
# plot(data2$rho, data2$alpha)
# fig<-ggplot(data2, aes(x=rho, y=alpha)) +
#   geom_point(size=2) + labs(x="Rho", y="Alpha") +
#   ggtitle("Panel C: Scatterplot of CES Parameters")
# sigma<-ggplot(data=data, aes(x=data$sigma)) +
#   geom_histogram(aes(x=data$sigma, y=100*(..count..)/sum(..count..)), binwidth=1)+
#   #geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
#   scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
#   ylim(c(0,25))+
#   labs(x="Sigma", y="Percent") +
#   ggtitle("Panel C: Sigma")
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(alpha, rho, nrow=2)
dev.off()
#Spearmans p
dat<-data[,c("alpha", "UG1", "UG2", "TG1", "TG2", "PGG", "SRAtotal")]
library(xtable)
library(Hmisc)
corstars <-function(x, method=c("pearson", "spearman"), removeTriangle=c("upper", "lower"),
result=c("none", "html", "latex")){
#Compute correlation matrix
require(Hmisc)
x <- as.matrix(x)
correlation_matrix<-rcorr(x, type=method[1])
R <- correlation_matrix$r # Matrix of correlation coeficients
p <- correlation_matrix$P # Matrix of p-value
## Define notions for significance levels; spacing is important.
#mystars <- ifelse(p < .0001, "****", ifelse(p < .001, "*** ", ifelse(p < .01, "**  ", ifelse(p < .05, "*   ", "    "))))
mystars <- ifelse(p < .01, "***", ifelse(p < .05, "**", ifelse(p<.1, "*", " ")))
## trunctuate the correlation matrix to two decimal
R <- format(round(cbind(rep(-1.11, ncol(x)), R), 2))[,-1]
## build a new matrix that includes the correlations with their apropriate stars
Rnew <- matrix(paste(R, mystars, sep=""), ncol=ncol(x))
diag(Rnew) <- paste(diag(R), " ", sep="")
rownames(Rnew) <- colnames(x)
colnames(Rnew) <- paste(colnames(x), "", sep="")
## remove upper triangle of correlation matrix
if(removeTriangle[1]=="upper"){
Rnew <- as.matrix(Rnew)
Rnew[upper.tri(Rnew, diag = TRUE)] <- ""
Rnew <- as.data.frame(Rnew)
}
## remove lower triangle of correlation matrix
else if(removeTriangle[1]=="lower"){
Rnew <- as.matrix(Rnew)
Rnew[lower.tri(Rnew, diag = TRUE)] <- ""
Rnew <- as.data.frame(Rnew)
}
#
## remove last column and return the correlation matrix
Rnew<-as.matrix(Rnew)
Rnew<-as.data.frame(Rnew)
Rnew <- cbind(Rnew[1:length(Rnew)])
if (result[1]=="none") return(Rnew)
else{
if(result[1]=="html") print(xtable(Rnew), type="html")
else print(xtable(Rnew), type="latex")
}
}
corstars(dat, method="pearson", result="latex")
dat1<-data[,c("alpha","rho1", "UG1", "UG2", "TG1", "TG2", "PGG")]
corstars(dat1, method="pearson", result="latex", removeTriangle="upper")
# regression
data$donations1<-data$donations
data$donations<-log(data$donations)
data$donations[data$donations==-Inf]<-NA
summary(data$donations)
hist(data$donations)
hist(data$donations1)
data$yr2018<-0
data$yr2017<-0
data$yr2016<-0
data$yr2015<-0
data$yr2014<-0
data$yr2013<-0
data$yr2018[data$CLASS_YR==2018]<-1
data$yr2017[data$CLASS_YR==2017]<-1
data$yr2016[data$CLASS_YR==2016]<-1
data$yr2015[data$CLASS_YR==2015]<-1
data$yr2014[data$CLASS_YR==2014]<-1
data$yr2013[data$CLASS_YR==2013]<-1
data$rho1<-data$rho/1000
model1<-lm(donations~alpha, data=data)
model2<-lm(donations~rho1, data=data)
model3<-lm(donations~UG1, data=data)
model4<-lm(donations~UG2, data=data)
model5<-lm(donations~TG1, data=data)
model6<-lm(donations~TG2, data=data)
model7<-lm(donations~PGG, data=data)
model8<-lm(donations~alpha+rho1+UG1+UG2+TG1+TG2+PGG, data=data)
model9<- lm(donations~SRAtotal, data=data)
model10<-lm(donations~SRAmoney, data=data)
model11 <- lm(donations ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal, data=data)
model12 <- lm(donations ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney, data=data)
data$gender1<-data$GENDER
data$GENDER<-data$gender1
data$GENDER<-0
data$GENDER[data$gender1=="F"]<-1
prop.table(table(data$MAJOR))
data$humanities<-0
data$social<-0
data$stem<-0
data$humanities[data$MAJOR=="African-American Studies"]<-1
data$social[data$MAJOR=="American Studies"]<-1
data$social[data$MAJOR=="Anthropology"]<-1
data$humanities[data$MAJOR=="Art History"]<-1
data$stem[data$MAJOR=="Astronomy"]<-1
data$stem[data$MAJOR=="Biology"]<-1
data$stem[data$MAJOR=="Chemistry"]<-1
data$humanities[data$MAJOR=="Classical Civilization"]<-1
data$humanities[data$MAJOR=="Classics"]<-1
data$humanities[data$MAJOR=="College of East Asian Studies"]<-1
data$humanities[data$MAJOR=="College of Letters"]<-1
data$social[data$MAJOR=="Colege of Social Studies"]<-1
data$stem[data$MAJOR=="Computer Science"]<-1
data$humanities[data$MAJOR=="Dance"]<-1
data$stem[data$MAJOR=="Earth And Environmental Science"]<-1
data$humanities[data$MAJOR=="East Asian Studies"]<-1
data$social[data$MAJOR=="Economics"]<-1
data$humanities[data$MAJOR=="English"]<-1
data$stem[data$MAJOR=="Environmental Studies"]<-1
data$humanities[data$MAJOR=="Feminist, Gender, & Sexuality"]<-1
data$humanities[data$MAJOR=="Film Studies"]<-1
data$humanities[data$MAJOR=="French Studies"]<-1
data$social[data$MAJOR=="Government"]<-1
data$humanities[data$MAJOR=="Hispanic Literatures and Cultures"]<-1
data$social[data$MAJOR=="History"]<-1
data$stem[data$MAJOR=="Mathematics"]<-1
data$social[data$MAJOR=="Mathematics/Economics"]<-1
data$stem[data$MAJOR=="Molecular Biology And Biochemistry"]<-1
data$humanities[data$MAJOR=="Music"]<-1
data$stem[data$MAJOR=="Neuroscience And Behavior Program"]<-1
data$social[data$MAJOR=="Philosophy"]<-1
data$stem[data$MAJOR=="Physics"]<-1
data$stem[data$MAJOR=="Psychology"]<-1
data$social[data$MAJOR=="Religion"]<-1
data$humanities[data$MAJOR=="Romance Studies"]<-1
data$humanities[data$MAJOR=="Russian East European Studies"]<-1
data$social[data$MAJOR=="Science In Society Program"]<-1
data$social[data$MAJOR=="Sociology"]<-1
data$humanities[data$MAJOR=="Spanish"]<-1
data$humanities[data$MAJOR=="Studio Arts"]<-1
data$humanities[data$MAJOR=="Theater"]<-1
model1<-lm(donations~alpha+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model2<-lm(donations~rho1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model3<-lm(donations~UG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model4<-lm(donations~UG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model5<-lm(donations~TG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model6<-lm(donations~TG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model7<-lm(donations~PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model8<-lm(donations~alpha+rho1+UG1+UG2+TG1+TG2+PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model9<- lm(donations~SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model10<-lm(donations~SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model11 <- lm(donations ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model12 <- lm(donations ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
View(data)
log(16863.31)
data$split<-0
data$split[data$CLASS_YR=='2017']<-1
data$split[data$CLASS_YR=='2018']<-5
train<-data[data$split==0,]
test<-data[data$split==1,]
model12<-lm(donations~alpha, data=train)
model13<-lm(donations~rho1,data=train)
model14<-lm(donations~UG1, data=train)
model15<-lm(donations~UG2, data=train)
model16<-lm(donations~TG1, data=train)
model17<-lm(donations~TG2, data=train)
model18<-lm(donations~PGG, data=train)
model19<-lm(donations~alpha+rho1+UG1+UG2+TG1+TG2+PGG, data=train)
model20<- lm(donations~SRAtotal, data=train)
model21<-lm(donations~SRAmoney, data=train)
model22 <- lm(donations ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal, data=train)
model23 <- lm(donations ~ alpha+rho1 + UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney, data=train)
mean((test$donations - predict.lm(model12, test)) ^ 2)
test$donations
test<-na.omit(test)
mean((test$donations - predict.lm(model12, test)) ^ 2)
sqrt(mean((test$donations - predict.lm(model12, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model13, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model14, test)) ^ 2))
stargazer(model12, model13, model14, model15, model16, model17,model18,model19,model20,model21,model22,model23, type="latex",
dep.var.labels=c("Log(Donations)"),
covariate.labels=c("Alpha", "Rho","Ultimatum1", "Ultimatum2", "Trust1",
"Trust2", "Cooperation","SRAtotal", "SRAmoney"))
sqrt(mean((test$donations - predict.lm(model15, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model16, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model17, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model18, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model19, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model20, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model21, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model22, test)) ^ 2))
sqrt(mean((test$donations - predict.lm(model23, test)) ^ 2))
