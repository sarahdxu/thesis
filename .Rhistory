pR2(model23)
mean((test$donations - predict.lm(model12, test)) ^ 2)
sqrt(mean((test$donations - predict.lm(model23, test)) ^ 2))
model <- lm(donations ~ 1, data=train)
actual<-test$donations
test<-na.omit(test)
predicted<-predict.lm(model, test)
rmse(actual, predicted)
stargazer(model12, model13, model14, model15, model16, model17,model18,model19,model20,model21,model22,model23, type="latex",
dep.var.labels=c("Donated"),
covariate.labels=c("Alpha", "Rho","Ultimatum1", "Ultimatum2", "Trust1",
"Trust2", "Cooperation","SRAtotal", "SRAmoney"))
mean((test$donations - predict.lm(model12, test)) ^ 2)
sqrt(mean((test$donations - predict.lm(model12, test)) ^ 2))
test<-na.omit(test)
actual<-test$donations
predicted<-predict.lm(model12, test)
rmse(actual, predicted)
predicted<-predict.lm(model13, test)
rmse(actual, predicted)
predicted<-predict.lm(model14, test)
rmse(actual, predicted)
predicted<-predict.lm(model15, test)
rmse(actual, predicted)
predicted<-predict.lm(model16, test)
rmse(actual, predicted)
predicted<-predict.lm(model17, test)
rmse(actual, predicted)
predicted<-predict.lm(model18, test)
rmse(actual, predicted)
predicted<-predict.lm(model19, test)
rmse(actual, predicted)
predicted<-predict.lm(model20, test)
rmse(actual, predicted)
predicted<-predict.lm(model21, test)
rmse(actual, predicted)
predicted<-predict.lm(model22, test)
rmse(actual, predicted)
predicted<-predict.lm(model23, test)
rmse(actual, predicted)
library(bestglm)
lbw.for.lm<-within(train, {
y<-donations
ID<-NULL
ResponseId<-NULL
GENDER<-NULL
CLASS_YR<-NULL
MAJOR<-NULL
current_donor_status<-NULL
DNR_GIVING<-NULL
DNR_TOTAL_YEARS<-NULL
first_gift<-NULL
last_gift<-NULL
last_gift_amount<-NULL
last_gift_for<-NULL
donations<-NULL
d<-NULL
donations1<-NULL
split<-NULL
sigma<-NULL
donated<-NULL
#   SRAtotal<-NULL
#   SRAmoney<-NULL
donations2<-NULL
donatoins2<-NULL
rho<-NULL
avgdonations<-NULL
yr2018<-NULL
yr2017<-NULL
yr2016<-NULL
yr2015<-NULL
yr2014<-NULL
yr2013<-NULL
gender1<-NULL
major1<-NULL
humanities<-NULL
social<-NULL
stem<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
lbw.for.lm<-na.omit(lbw.for.lm)
lbw.for.lm<-within(lbw.for.lm, {
SRAtotal<-NULL
SRAmoney<-NULL
})
res.bestglm<-
bestglm(Xy=lbw.for.lm,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
best.model.lm1<-lm(donations~rho1+TG2+PGG+SRA4+SRA5+SRA6,data=train)
best.model.lm2<-lm(donations~rho1+TG2+PGG+SRA1+SRA4+SRA5+SRA6,data=train)
best.model.lm3<-lm(donations~rho1+TG2+UG1+PGG+SRA4+SRA5+SRA6,data=train)
best.model.lm4<-lm(donations~rho1+TG2+UG1+PGG+SRA1+SRA4+SRA5+SRA6,data=train)
best.model.lm5<-lm(donations~TG2+UG1+PGG+SRA4+SRA5+SRA6,data=train)
stargazer(best.model.lm4, best.model.lm3,best.model.lm2,best.model.lm1,best.model.lm5, type="latex",
dep.var.labels=c("Log(Donations)")
)
model12
stargazer(best.model.lm4, best.model.lm3,best.model.lm2,best.model.lm1,best.model.lm5, type="latex",
dep.var.labels=c("Log(Average Donations)"),
covariate.labels=c("Rho","Trust2", "Ultimatum1", "Cooperation",
"SRA1", "SRA4", "SRA5", "SRA6"))
test<-na.omit(test)
actual<-test$donations
predicted<-predict.lm(best.model.lm4, test)
rmse(actual, predicted)
predicted<-predict.lm(best.model.lm3, test)
rmse(actual, predicted)
predicted<-predict.lm(best.model.lm2, test)
rmse(actual, predicted)
predicted<-predict.lm(best.model.lm1, test)
rmse(actual, predicted)
predicted<-predict.lm(best.model.lm5, test)
rmse(actual, predicted)
best.model.lm5<-lm(donations~rho1+TG2+SRA4+SRA5+SRA6,data=train)
stargazer(best.model.lm4, best.model.lm3,best.model.lm2,best.model.lm1,best.model.lm5, type="latex",
dep.var.labels=c("Log(Average Donations)"),
covariate.labels=c("Rho","Trust2", "Ultimatum1", "Cooperation",
"SRA1", "SRA4", "SRA5", "SRA6"))
predicted<-predict.lm(best.model.lm5, test)
rmse(actual, predicted)
best.model.lm1<-lm(donations~alpha+avgreturn+SRA1+SRA4+SRA6,data=train)
best.model.lm2<-lm(donations~alpha+avgreturn+SRA4+SRA5+SRA6,data=train)
best.model.lm3<-lm(donations~alpha+avgreturn+SRA1+SRA4+SRA5+SRA6,data=train)
best.model.lm4<-lm(donations~avgreturn+SRA1+SRA4+SRA6,data=train)
res.bestglm<-
bestglm(Xy=lbw.for.lm,
family=gaussian,
IC="AIC",
method="exhaustive")
res.bestglm$BestModels
best.model.lm1<-lm(donations~rho1+TG2+PGG+SRA4+SRA5+SRA6,data=train)
best.model.lm2<-lm(donations~rho1+TG2+PGG+SRA1+SRA4+SRA5+SRA6,data=train)
best.model.lm3<-lm(donations~rho1+TG2+UG1+PGG+SRA4+SRA5+SRA6,data=train)
best.model.lm4<-lm(donations~rho1+TG2+UG1+PGG+SRA1+SRA4+SRA5+SRA6,data=train)
best.model.lm5<-lm(donations~TG2+UG1+PGG+SRA4+SRA5+SRA6,data=train)
predicted<-predict.lm(best.model.lm5, test)
rmse(actual, predicted)
stargazer(best.model.lm4, best.model.lm3,best.model.lm2,best.model.lm1,best.model.lm5, type="latex",
dep.var.labels=c("Log(Average Donations)"),
covariate.labels=c("Rho","Trust2", "Ultimatum1", "Cooperation",
"SRA1", "SRA4", "SRA5", "SRA6"))
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
x<-model.matrix(y~.,lbw.for.lm)[,-1]
y<-lbw.for.lm$y
cv.out<-cv.glmnet(x,y,alpha=1,type.measure="mse")
lambda_min<-cv.out$lambda.min
lambda_1se<-cv.out$lambda.1se
coef(cv.out,s=lambda_min)
lbw.for.lm1<-within(test, {
y<-donations
ID<-NULL
ResponseId<-NULL
GENDER<-NULL
CLASS_YR<-NULL
MAJOR<-NULL
current_donor_status<-NULL
DNR_GIVING<-NULL
DNR_TOTAL_YEARS<-NULL
first_gift<-NULL
last_gift<-NULL
last_gift_amount<-NULL
last_gift_for<-NULL
donations<-NULL
d<-NULL
donations1<-NULL
split<-NULL
sigma<-NULL
donated<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
donations2<-NULL
donatoins2<-NULL
rho<-NULL
avgdonations<-NULL
yr2018<-NULL
yr2017<-NULL
yr2016<-NULL
yr2015<-NULL
yr2014<-NULL
yr2013<-NULL
gender1<-NULL
major1<-NULL
humanities<-NULL
social<-NULL
stem<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
lbw.for.lm1<-na.omit(lbw.for.lm1)
xtest<-model.matrix(y~.,lbw.for.lm1)[,-1]
ytest<-lbw.for.lm1$y
yhat<-predict(cv.out,s=lambda_min,newx=xtest)
mse<-mean((ytest-yhat)^2)
rmse(ytest, yhat)
m<-lars(x,y,type="lasso")
covTest(m,x,y)
View(data)
data$don<-log(data$avgdonations)
ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)))+
labs(x="Log(Average Donations)", y="Percent")
ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Log(Average Donations)", y="Percent")
ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=1)+
labs(x="Log(Average Donations)", y="Percent")
ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5)+
labs(x="Log(Average Donations)", y="Percent")
ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5)+
labs(x="Log(Average Donations)", y="Percent")
avgdonations<-ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5)+
labs(x="Log(Average Donations)", y="Percent")+
ggtitle("Panel M: Log of Average Donations")
pdf("~/Desktop/thesis/paper/images/Figure4.pdf",width=11,height=8.5)
grid.arrange(donations, logdonations,avgdonations, nrow=3)
dev.off()
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha") + theme(plot.title = element_text(hjust = 0.5))
alpha<-ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha") + theme(plot.title = element_text(hjust = 0.5))
ggsave("~/Desktop/thesis/paper/images/alpha.pdf", width=11, height=8.5)
rho<-ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")+ theme(plot.title = element_text(hjust = 0.5))
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(alpha, rho, nrow=2)
dev.off()
alpha<-ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05)+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggsave("~/Desktop/thesis/paper/images/alpha.pdf", width=11, height=8.5)
rho<-ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(alpha, rho, nrow=2)
dev.off()
avgdonated<-ggplot(df, aes(classyr, donated)) + geom_bar(stat="identity") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Percent Donated")+
ggtitle("Panel N: Percent Donated by Class Year")
avgtotaldonation<-ggplot(df, aes(classyr, avgtotaldonations)) + geom_bar(stat="identity") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Total Donation Amounts")+
ggtitle("Panel O: Average Total Donation Amount by Class Year")
avgdonation<-ggplot(df, aes(classyr, avgdonations)) + geom_bar(stat="identity") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Donation Amounts")+
ggtitle("Panel P: Average Donation Amount by Class Year")
pdf("~/Desktop/thesis/paper/images/Figure6.pdf",width=11,height=8.5)
grid.arrange(avgdonated, avgtotaldonation,avgdonation, nrow=3)
dev.off()
ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
data1$rho1[data1$rho1<(-1)]<-(-1.25)
ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
data1<-data
data1$rho1<-data1$rho
data1<-data
data1$rho1<-data1$rho
data1$rho1[data1$rho1<(-1)]<-(-1.25)
data1<-data
data1$rho1<-data1$rho
data1$rho1[data1$rho1<(-1)]<-(-1.25)
ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.2)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
rho<-ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05)+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.2)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(alpha, rho, nrow=2)
dev.off()
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="skyblue4")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="skyblue1")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="slategray3")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="lightblue4")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="lightblue1")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="#aaa7cf")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="slategray")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="slategray1")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="slategray4")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
alpha<-ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="slategray4")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggsave("~/Desktop/thesis/paper/images/alpha.pdf", width=11, height=8.5)
summary(data$UG1)
rho<-ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="slategray4")+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.2)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(alpha, rho, nrow=2)
dev.off()
UG1<-ggplot(data=data, aes(data$UG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..)), fill="slategray4") +
#  labs(title="Total SRA Scores") +
ggtitle("Panel C: Ultimatum Game Proposers") +
labs(x="Pass Rate", y="Percent") + ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG1.pdf", width=11, height=8.5)
UG2<-ggplot(data=data, aes(data$UG2))+
geom_bar(aes(y= 100*(..count..)/sum(..count..)), fill="slategray4") +
#  labs(title="Total SRA Scores")
ggtitle("Panel D: Ultimatum Game Responders")+
labs(x="Minimum Contribution Accepted", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1))
ggsave("~/Desktop/thesis/output/UG2.pdf", width=11, height=8.5)
TG1<-ggplot(data=data, aes(data$TG1))+
geom_bar(aes(y= 100*(..count..)/sum(..count..))) +ylim(c(0,45), fill="slategray4")+
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel E: Trust Game Proposers")
ggsave("~/Desktop/thesis/output/TG1.pdf", width=11, height=8.5)
PGG<-ggplot(data=data, aes(data$PGG))+
geom_bar(aes(y= 100*(..count..)/sum(..count..)), fill="slategray4") +
#  labs(title="Total SRA Scores") +
labs(x="Pass Rate", y="Percent")+ylim(c(0,45))+
scale_x_continuous(breaks=seq(0,1,0.1)) +
ggtitle("Panel F: Public Goods Game")
ggsave("~/Desktop/thesis/output/PGG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2b.pdf",width=11,height=8.5)
grid.arrange(UG1, UG2, TG1, PGG, nrow=2)
dev.off()
TG2<-ggplot(data=data, aes(data$TG2)) +
geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=.05, fill="slategray4") +
labs(x="Reciprocity", y="Percent") +
ggtitle("Panel G: Reciprocity Levels") +
scale_x_continuous(breaks=seq(-0.5, 1, by=0.1)) + ylim(c(0,28))
ggsave("~/Desktop/thesis/paper/images/TG2.pdf", width=11, height=8.5)
TG<-ggplot(data=data, aes(data$avgreturn)) +
geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="slategray4")+
ylim(c(0,28))+labs(x="Repayment Rate", y="Percent") + ggtitle("Panel H: Average Repayment Rate") +
scale_x_continuous(breaks=seq(0, 1, by=0.1))
ggsave("~/Desktop/thesis/paper/images/TG.pdf", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure2c.pdf",width=11,height=8.5)
grid.arrange(TG2, TG, nrow=2)
dev.off()
donated<-ggplot(data=data, aes(data$donated))+
geom_bar(aes(y= 100*(..count..)/sum(..count..)), fill="slategray4") +
#  labs(title="Total SRA Scores") +
labs(x="Donated", y="Percent") + scale_x_continuous(breaks=seq(0,1,1)) + ylim(c(0,80))+
ggtitle("Panel K: Donations")
ggsave("~/Desktop/thesis/paper/images/donated.pdf", width=11, height=8.5)
donations<-ggplot(data=data, aes(data$d))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=10, fill="slategray4")+
labs(x="Donations", y="Percent")+scale_x_continuous(breaks=seq(0,100,10))+
ggtitle("Panel K: Total Donations")
ylim(c(0,60))+
ggsave("~/Desktop/thesis/paper/images/donations.pdf", width=11, height=8.5)
data$donations1<-data$donations
data$donations<-log(data$donations)
data$donations[data$donations==-Inf]<-NA
logdonations<-ggplot(data=data, aes(data$donations))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5, fill="slategray4")+
labs(x="Log(Donations)", y="Percent")+scale_x_continuous(breaks=seq(-6,10,2))+
logdonations<-ggplot(data=data, aes(data$donations1))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5, fill="slategray4")+
labs(x="Log(Donations)", y="Percent")+scale_x_continuous(breaks=seq(-6,10,2))+
ggtitle("Panel L: Log of Total Donations")
avgdonations<-ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5, fill="slategray4")+
labs(x="Log(Average Donations)", y="Percent")+
ggtitle("Panel N: Log of Average Donations")
pdf("~/Desktop/thesis/paper/images/Figure4.pdf",width=11,height=8.5)
grid.arrange(donations, logdonations,avgdonations, nrow=3)
dev.off()
avgtotaldonation<-ggplot(df, aes(classyr, avgtotaldonations)) + geom_bar(stat="identity", , fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Total Donation Amounts")+
ggtitle("Panel O: Average Total Donation Amount by Class Year")
avgdonation<-ggplot(df, aes(classyr, avgdonations)) + geom_bar(stat="identity", fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Donation Amounts")+
ggtitle("Panel P: Average Donation Amount by Class Year")
avgdonated<-ggplot(df, aes(classyr, donated)) + geom_bar(stat="identity", fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Percent Donated")+
ggtitle("Panel N: Percent Donated by Class Year")
pdf("~/Desktop/thesis/paper/images/Figure6.pdf",width=11,height=8.5)
grid.arrange(avgdonated, avgtotaldonation,avgdonation, nrow=3)
dev.off()
SRA<-ggplot(data=data, aes(data$SRAtotal))+
geom_bar(aes(y= 100*(..count..)/sum(..count..)), fill="slategray4") +
#  labs(title="Total SRA Scores") +
labs(x="Total Scores", y="Percent") +
scale_x_continuous(breaks=seq(20,50,2)) + ggtitle("Panel I: Total SRA Scores")
ggsave("~/Desktop/thesis/paper/images/SRAimg.jpg", width=11, height=8.5)
SRAmoney<-ggplot(data=data, aes(data$SRAmoney))+
geom_bar(aes(y= 100*(..count..)/sum(..count..)), fill="slategray4") +
#  labs(title="Total SRA Scores") +
labs(x="SRA Money Scores", y="Percent") +ggtitle("Panel J: Monetary SRA Scores")+
ggsave("~/Desktop/thesis/paper/images/SRAmoney.jpg", width=11, height=8.5)
pdf("~/Desktop/thesis/paper/images/Figure3.pdf",width=11,height=8.5)
grid.arrange(SRA, SRAmoney, nrow=2)
dev.off()
