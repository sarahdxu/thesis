data$avgdonations[data$CLASS_YR=="2016"]<-data$donations1[data$CLASS_YR=="2016"]/3
data$avgdonations[data$CLASS_YR=="2015"]<-data$donations1[data$CLASS_YR=="2015"]/4
data$avgdonations[data$CLASS_YR=="2014"]<-data$donations1[data$CLASS_YR=="2014"]/5
data$avgdonations[data$CLASS_YR=="2013"]<-data$donations1[data$CLASS_YR=="2013"]/6
data$don<-log(data$avgdonations)
avgdonations<-ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5, fill="slategray4")+
labs(x="Log(Average Donations)", y="Percent")+
ggtitle("Panel N: Log of Average Donations")
pdf("~/Desktop/thesis/paper/images/Figure4.pdf",width=11,height=8.5)
grid.arrange(donations, logdonations,avgdonations, nrow=3)
dev.off()
data2018<-data[data$CLASS_YR==2018,]
data2018$donations1[data2018$donations1>=500]<-NA
data2017<-data[data$CLASS_YR==2017,]
data2017$donations1[data2017$donations1>=500]<-NA
data2016<-data[data$CLASS_YR==2016,]
data2016$donations1[data2016$donations1>=400]<-NA
data2015<-data[data$CLASS_YR==2015,]
data2015$donations1[data2015$donations1>=300]<-NA
data2014<-data[data$CLASS_YR==2014,]
data2014$donations1[data2014$donations1>=400]<-NA
data2013<-data[data$CLASS_YR==2013,]
data2013$donations1[data2013$donations1>=2000]<-NA
# install.packages("ggplot2")
# library(ggplot2)
# donations2018<-ggplot(data2018, aes(data2018$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,35,5))+
#   ylim(c(0,100))+
#   ggtitle("2018 Donation Amounts")
#
# donations2017<-ggplot(data2017, aes(data2017$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,40,5))+
#   ylim(c(0,80))+
#   ggtitle("2017 Donation Amounts")
# donations2016<-ggplot(data2016, aes(data2016$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,40,5))+
#   ylim(c(0,35))+
#   ggtitle("2016 Donation Amounts")
#
# donations2015<-ggplot(data2015, aes(data2015$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,90,5))+
#   ylim(c(0,35))+
#   ggtitle("2015 Donation Amounts")
#
# donations2014<-ggplot(data2014, aes(data2014$d)) +geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
#   labs(x="Donation Amount", y="Percent")+scale_x_continuous(breaks=seq(0,70,5))+
#   ylim(c(0,35))+
#   ggtitle("2014 Donation Amounts")
# data$donations2<-data$donations1
# data$donatoins2[data$donations1>1000]<-NA
# summary(data$donations[data$CLASS_YR==2018])
# summary(data$donations[data$CLASS_YR==2017])
# summary(data$donations[data$CLASS_YR==2016])
# summary(data$donations[data$CLASS_YR==2015])
# summary(data$donations[data$CLASS_YR==2014])
# summary(data$donations[data$CLASS_YR==2013])
summary(data2018$donations1)
summary(data2017$donations1)
summary(data2016$donations1)
summary(data2015$donations1)
summary(data2014$donations1)
summary(data2013$donations1)
summary(data2018$donated)
summary(data2017$donated)
summary(data2016$donated)
summary(data2015$donated)
summary(data2014$donated)
summary(data2013$donated)
df<-data.frame(classyr=c("2018", "2017", "2016", "2015", "2014", "2013"),
avgtotaldonations=c(2.779, 7.276, 11.99, 26.09, 44.02, 68.87),
avgdonations=c(2.779, 3.638, 3.997, 6.52, 8.804, 11.478),
donated=c(0.2857, 0.6316, 0.7231, 0.6875, 0.7143, 0.9074))
avgtotaldonation<-ggplot(df, aes(classyr, avgtotaldonations)) + geom_bar(stat="identity", , fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Total Donation Amounts")+
ggtitle("Panel O: Average Total Donation Amount by Class Year")
avgdonation<-ggplot(df, aes(classyr, avgdonations)) + geom_bar(stat="identity", fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Donation Amounts")+
ggtitle("Panel P: Average Donation Amount by Class Year")
avgdonated<-ggplot(df, aes(classyr, donated)) + geom_bar(stat="identity", fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Percent Donated")+
ggtitle("Panel N: Percent Donated by Class Year")
pdf("~/Desktop/thesis/paper/images/Figure6.pdf",width=11,height=8.5)
grid.arrange(avgdonated, avgtotaldonation,avgdonation, nrow=3)
dev.off()
library(gridExtra)
# e<-data[data$donation>625,]
# prop.table(table(e$donation))
# summary(data$donation)
#GDG
alpha<-ggplot(data=data, aes(data$alpha)) + geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="slategray4")+
scale_x_continuous(breaks=seq(0, 1, by=0.1)) +
#ylim(c(0,28))+
labs(x="Alpha", y="Percent") +
ggtitle("Panel A: Alpha")
ggsave("~/Desktop/thesis/paper/images/alpha.pdf", width=11, height=8.5)
summary(data$UG1)
#data$rho1[data$rho1>1]<-NA
data1<-data
data1$rho1<-data1$rho
data1$rho1[data1$rho1<(-1)]<-(-1.25)
#data2<-data[data$rho>1,]
rho<-ggplot(data=data1, aes(x=rho1)) +
geom_histogram(aes(x=rho1, y=100*(..count..)/sum(..count..)), binwidth=0.05, fill="slategray4")+
#geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
scale_x_continuous(breaks=seq(-1, 1, by=0.2)) +
labs(x="Rho", y="Percent") +
ggtitle("Panel B: Rho")
ggsave("~/Desktop/thesis/paper/images/rho.pdf", width=11, height=8.5)
# data2<-data[data$rho<=1 & data$rho>=-1,]
# plot(data2$rho, data2$alpha)
# fig<-ggplot(data2, aes(x=rho, y=alpha)) +
#   geom_point(size=2) + labs(x="Rho", y="Alpha") +
#   ggtitle("Panel C: Scatterplot of CES Parameters")
# sigma<-ggplot(data=data, aes(x=data$sigma)) +
#   geom_histogram(aes(x=data$sigma, y=100*(..count..)/sum(..count..)), binwidth=1)+
#   #geom_histogram(aes(x=data1$rho1[data1$rho1==-1.25], y=100*(..count..)/sum(..count..)),binwidth=0.05)+
#   scale_x_continuous(breaks=seq(-1, 1, by=0.1)) +
#   ylim(c(0,25))+
#   labs(x="Sigma", y="Percent") +
#   ggtitle("Panel C: Sigma")
pdf("~/Desktop/thesis/paper/images/Figure2a.pdf",width=11,height=8.5)
grid.arrange(alpha, rho, nrow=2)
dev.off()
#Spearmans p
dat<-data[,c("alpha", "UG1", "UG2", "TG1", "TG2", "PGG", "SRAtotal")]
library(xtable)
library(Hmisc)
corstars <-function(x, method=c("pearson", "spearman"), removeTriangle=c("upper", "lower"),
result=c("none", "html", "latex")){
#Compute correlation matrix
require(Hmisc)
x <- as.matrix(x)
correlation_matrix<-rcorr(x, type=method[1])
R <- correlation_matrix$r # Matrix of correlation coeficients
p <- correlation_matrix$P # Matrix of p-value
## Define notions for significance levels; spacing is important.
#mystars <- ifelse(p < .0001, "****", ifelse(p < .001, "*** ", ifelse(p < .01, "**  ", ifelse(p < .05, "*   ", "    "))))
mystars <- ifelse(p < .01, "***", ifelse(p < .05, "**", ifelse(p<.1, "*", " ")))
## trunctuate the correlation matrix to two decimal
R <- format(round(cbind(rep(-1.11, ncol(x)), R), 2))[,-1]
## build a new matrix that includes the correlations with their apropriate stars
Rnew <- matrix(paste(R, mystars, sep=""), ncol=ncol(x))
diag(Rnew) <- paste(diag(R), " ", sep="")
rownames(Rnew) <- colnames(x)
colnames(Rnew) <- paste(colnames(x), "", sep="")
## remove upper triangle of correlation matrix
if(removeTriangle[1]=="upper"){
Rnew <- as.matrix(Rnew)
Rnew[upper.tri(Rnew, diag = TRUE)] <- ""
Rnew <- as.data.frame(Rnew)
}
## remove lower triangle of correlation matrix
else if(removeTriangle[1]=="lower"){
Rnew <- as.matrix(Rnew)
Rnew[lower.tri(Rnew, diag = TRUE)] <- ""
Rnew <- as.data.frame(Rnew)
}
#
## remove last column and return the correlation matrix
Rnew<-as.matrix(Rnew)
Rnew<-as.data.frame(Rnew)
Rnew <- cbind(Rnew[1:length(Rnew)])
if (result[1]=="none") return(Rnew)
else{
if(result[1]=="html") print(xtable(Rnew), type="html")
else print(xtable(Rnew), type="latex")
}
}
corstars(dat, method="pearson", result="latex")
dat1<-data[,c("alpha","rho1", "UG1", "UG2", "TG1", "TG2", "PGG")]
corstars(dat1, method="pearson", result="latex", removeTriangle="upper")
# regression
summary(data$donations)
hist(data$donations)
hist(data$donations1)
data$yr2018<-0
data$yr2017<-0
data$yr2016<-0
data$yr2015<-0
data$yr2014<-0
data$yr2013<-0
data$yr2018[data$CLASS_YR==2018]<-1
data$yr2017[data$CLASS_YR==2017]<-1
data$yr2016[data$CLASS_YR==2016]<-1
data$yr2015[data$CLASS_YR==2015]<-1
data$yr2014[data$CLASS_YR==2014]<-1
data$yr2013[data$CLASS_YR==2013]<-1
data$rho1<-data$rho/1000
data$gender1<-data$GENDER
data$GENDER<-data$gender1
data$GENDER<-0
data$GENDER[data$gender1=="F"]<-1
data$humanities<-0
data$social<-0
data$stem<-0
data$humanities[data$MAJOR=="African-American Studies"]<-1
data$social[data$MAJOR=="American Studies"]<-1
data$social[data$MAJOR=="Anthropology"]<-1
data$humanities[data$MAJOR=="Art History"]<-1
data$stem[data$MAJOR=="Astronomy"]<-1
data$stem[data$MAJOR=="Biology"]<-1
data$stem[data$MAJOR=="Chemistry"]<-1
data$humanities[data$MAJOR=="Classical Civilization"]<-1
data$humanities[data$MAJOR=="Classics"]<-1
data$humanities[data$MAJOR=="College of East Asian Studies"]<-1
data$humanities[data$MAJOR=="College of Letters"]<-1
data$social[data$MAJOR=="Colege of Social Studies"]<-1
data$stem[data$MAJOR=="Computer Science"]<-1
data$humanities[data$MAJOR=="Dance"]<-1
data$stem[data$MAJOR=="Earth And Environmental Science"]<-1
data$social[data$MAJOR=="Economics"]<-1
data$humanities[data$MAJOR=="East Asian Studies"]<-1
data$humanities[data$MAJOR=="English"]<-1
data$stem[data$MAJOR=="Environmental Studies"]<-1
data$humanities[data$MAJOR=="Feminist, Gender, & Sexuality"]<-1
data$humanities[data$MAJOR=="Film Studies"]<-1
data$humanities[data$MAJOR=="French Studies"]<-1
data$social[data$MAJOR=="Government"]<-1
data$humanities[data$MAJOR=="Hispanic Literatures and Cultures"]<-1
data$social[data$MAJOR=="History"]<-1
data$stem[data$MAJOR=="Mathematics"]<-1
data$social[data$MAJOR=="Mathematics/Economics"]<-1
data$stem[data$MAJOR=="Molecular Biology And Biochemistry"]<-1
data$humanities[data$MAJOR=="Music"]<-1
data$stem[data$MAJOR=="Neuroscience And Behavior Program"]<-1
data$social[data$MAJOR=="Philosophy"]<-1
data$stem[data$MAJOR=="Physics"]<-1
data$stem[data$MAJOR=="Psychology"]<-1
data$social[data$MAJOR=="Religion"]<-1
data$humanities[data$MAJOR=="Romance Studies"]<-1
data$humanities[data$MAJOR=="Russian East European Studies"]<-1
data$social[data$MAJOR=="Science In Society Program"]<-1
data$humanities[data$MAJOR=="Spanish"]<-1
data$social[data$MAJOR=="Sociology"]<-1
data$humanities[data$MAJOR=="Studio Arts"]<-1
data$humanities[data$MAJOR=="Theater"]<-1
model1<-lm(donations~alpha+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
data$avgdonations<-0
data$avgdonations[data$CLASS_YR=="2018"]<-data$donations1[data$CLASS_YR=="2018"]
data$avgdonations[data$CLASS_YR=="2017"]<-data$donations1[data$CLASS_YR=="2017"]/2
data$avgdonations[data$CLASS_YR=="2016"]<-data$donations1[data$CLASS_YR=="2016"]/3
data$avgdonations[data$CLASS_YR=="2015"]<-data$donations1[data$CLASS_YR=="2015"]/4
data$avgdonations[data$CLASS_YR=="2014"]<-data$donations1[data$CLASS_YR=="2014"]/5
data$avgdonations[data$CLASS_YR=="2013"]<-data$donations1[data$CLASS_YR=="2013"]/6
data$don<-log(data$avgdonations)
model1<-lm(donations~alpha+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model2<-lm(donations~rho1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model3<-lm(donations~UG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model4<-lm(donations~UG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model5<-lm(donations~TG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model6<-lm(donations~TG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model7<-lm(donations~PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model8<-lm(donations~alpha+rho1+UG1+UG2+TG1+TG2+PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model9<- lm(donations~SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model10<-lm(donations~SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model11 <- lm(donations ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model12 <- lm(donations ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
stargazer(model1, model2, model3, model4, model5, model6,model7,model8,model9, model10, model11,model12,type="latex",
dep.var.labels=c("Log(Donations)"),
covariate.labels=c("Alpha", "Rho","Ultimatum1", "Ultimatum2", "Trust1",
"Trust2", "Cooperation", "SRAtotal", "SRAmoney",
"2017", "2016", "2015", "2014", "2013", "Female", "Humanities", "STEM"))
data$don[data$don==-Inf]<-NA
model1<-lm(don~alpha+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model2<-lm(don~rho1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model3<-lm(don~UG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model4<-lm(don~UG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model5<-lm(don~TG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model6<-lm(don~TG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model7<-lm(don~PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model8<-lm(don~alpha+rho1+UG1+UG2+TG1+TG2+PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model9<- lm(don~SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model10<-lm(don~SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model11 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model12 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
stargazer(model1, model2, model3, model4, model5, model6,model7,model8,model9, model10, model11,model12,type="latex",
dep.var.labels=c("Log(Average Donations)"),
covariate.labels=c("Alpha", "Rho","Ultimatum1", "Ultimatum2", "Trust1",
"Trust2", "Cooperation", "SRAtotal", "SRAmoney",
"2017", "2016", "2015", "2014", "2013", "Female", "Humanities", "STEM"))
model1<-lm(don~alpha+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model2<-lm(don~rho1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model3<-lm(don~UG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model4<-lm(don~UG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model5<-lm(don~TG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model6<-lm(don~TG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model7<-lm(don~PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model8<-lm(don~alpha+rho1+UG1+UG2+TG1+TG2+PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model9<- lm(don~SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model10<-lm(don~SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model11 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model12 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
stargazer(model1, model2, model3, model4, model5, model6,model7,model8,model9, model10, model11,model12,type="latex",
dep.var.labels=c("Log(Average Donations)"),
covariate.labels=c("Alpha", "Rho","Ultimatum1", "Ultimatum2", "Trust1",
"Trust2", "Cooperation", "SRAtotal", "SRAmoney",
"2017", "2016", "2015", "2014", "2013", "Female", "Humanities", "STEM"))
data$avgdonations<-0
data$avgdonations[data$CLASS_YR=="2018"]<-data$donations1[data$CLASS_YR=="2018"]
data$avgdonations[data$CLASS_YR=="2017"]<-data$donations1[data$CLASS_YR=="2017"]/2
data$avgdonations[data$CLASS_YR=="2016"]<-data$donations1[data$CLASS_YR=="2016"]/3
data$avgdonations[data$CLASS_YR=="2015"]<-data$donations1[data$CLASS_YR=="2015"]/4
data$avgdonations[data$CLASS_YR=="2014"]<-data$donations1[data$CLASS_YR=="2014"]/5
data$avgdonations[data$CLASS_YR=="2013"]<-data$donations1[data$CLASS_YR=="2013"]/6
data$don<-log(data$avgdonations)
data$don[data$don==-Inf]<-NA
model1<-lm(don~alpha+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model2<-lm(don~rho1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model3<-lm(don~UG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model4<-lm(don~UG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model5<-lm(don~TG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model6<-lm(don~TG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model7<-lm(don~PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model8<-lm(don~alpha+rho1+UG1+UG2+TG1+TG2+PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model9<- lm(don~SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model10<-lm(don~SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model11 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
model12 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
stargazer(model1, model2, model3, model4, model5, model6,model7,model8,model9, model10, model11,model12,type="latex",
dep.var.labels=c("Log(Average Donations)"),
covariate.labels=c("Alpha", "Rho","Ultimatum1", "Ultimatum2", "Trust1",
"Trust2", "Cooperation", "SRAtotal", "SRAmoney",
"2017", "2016", "2015", "2014", "2013", "Female", "Humanities", "STEM"))
model1<-lm(don~alpha+GENDER+humanities+stem, data=data)
model2<-lm(don~rho1+GENDER+humanities+stem, data=data)
model3<-lm(don~UG1+GENDER+humanities+stem, data=data)
model4<-lm(don~UG2+GENDER+humanities+stem, data=data)
model5<-lm(don~TG1+GENDER+humanities+stem, data=data)
model6<-lm(don~TG2+GENDER+humanities+stem, data=data)
model7<-lm(don~PGG+GENDER+humanities+stem, data=data)
model8<-lm(don~alpha+rho1+UG1+UG2+TG1+TG2+PGG+GENDER+humanities+stem, data=data)
model9<- lm(don~SRAtotal+GENDER+humanities+stem, data=data)
model10<-lm(don~SRAmoney+GENDER+humanities+stem, data=data)
model11 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal+GENDER+humanities+stem, data=data)
model12 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney+GENDER+humanities+stem, data=data)
stargazer(model1, model2, model3, model4, model5, model6,model7,model8,model9, model10, model11,model12,type="latex",
dep.var.labels=c("Log(Average Donations)"),
covariate.labels=c("Alpha", "Rho","Ultimatum1", "Ultimatum2", "Trust1",
"Trust2", "Cooperation", "SRAtotal", "SRAmoney",
"Female", "Humanities", "STEM"))
model12<-glm(donated~alpha+GENDER+humanities+stem, data=data)
pR2(model12)
model13<-glm(donated~rho1+GENDER+humanities+stem,data=data)
pR2(model13)
model14<-glm(donated~UG1+GENDER+humanities+stem, data=data)
pR2(model14)
model15<-glm(donated~UG2+GENDER+humanities+stem, data=data)
pR2(model15)
model16<-glm(donated~TG1+GENDER+humanities+stem, data=data)
pR2(model16)
model17<-glm(donated~TG2+GENDER+humanities+stem, data=data)
pR2(model17)
model18<-glm(donated~PGG+GENDER+humanities+stem, data=data)
pR2(model18)
model19<-glm(donated~alpha+rho1+UG1+UG2+TG1+TG2+PGG+GENDER+humanities+stem, data=data)
pR2(model19)
model20<- glm(donated~SRAtotal+GENDER+humanities+stem, data=data)
pR2(model20)
model21<-glm(donated~SRAmoney+GENDER+humanities+stem, data=data)
pR2(model21)
model22 <- glm(donated ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal+GENDER+humanities+stem, data=data)
pR2(model22)
model23 <- glm(donated ~ alpha+rho1 + UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney+GENDER+humanities+stem, data=data)
stargazer(model12, model13, model14, model15, model16, model17,model18,model19,model20,model21,model22,model23, type="latex",
dep.var.labels=c("Donated"),
covariate.labels=c("Alpha", "Rho","Ultimatum1", "Ultimatum2", "Trust1",
"Trust2", "Cooperation","SRAtotal", "SRAmoney",
"Female", "Humanities", "STEM"))
pR2(model12)
pR2(model13)
pR2(model14)
pR2(model15)
pR2(model16)
pR2(model17)
pR2(model18)
pR2(model19)
pR2(model20)
pR2(model21)
pR2(model22)
pR2(model23)
model12<-glm(donated~alpha+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model12)
model13<-glm(donated~rho1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem,data=data)
pR2(model13)
model14<-glm(donated~UG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model14)
model15<-glm(donated~UG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model15)
model16<-glm(donated~TG1+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model16)
model17<-glm(donated~TG2+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model17)
model18<-glm(donated~PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model18)
model19<-glm(donated~alpha+rho1+UG1+UG2+TG1+TG2+PGG+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model19)
model20<- glm(donated~SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model20)
model21<-glm(donated~SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model21)
model22 <- glm(donated ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model22)
model23 <- glm(donated ~ alpha+rho1 + UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
pR2(model23)
data1<-data[,c("don", "alpha","rho1", "sigma", "UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRA1", "SRA2","SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10",
"SRAtotal", "SRAmoney")]
data2<-data[,c("don", "alpha","UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRA1", "SRA2","SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10",
"SRAtotal", "SRAmoney")]
data3<-data[,c("don", "alpha","UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRAtotal", "SRAmoney")]
data4<-data[,c("donated", "alpha","UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRAtotal", "SRAmoney")]
data5<-data[,c("donated", "alpha","rho1", "sigma", "UG1", "UG2", "TG1", "TG2","avgreturn","PGG",
"SRA1", "SRA2","SRA3", "SRA4", "SRA5", "SRA6", "SRA7", "SRA8", "SRA9", "SRA10",
"SRAtotal", "SRAmoney")]
library(bestglm)
lbw.for.glm<-within(data1, {
y<-don
sigma<-NULL
View(data1)
View(data1)
lbw.for.glm<-within(data1, {
y<-don
sigma<-NULL
don<-NULL
SRAtotal<-NULL
SRAmoney<-NULL
#   SRA1<-NULL
#   SRA2<-NULL
#   SRA3<-NULL
#   SRA4<-NULL
#   SRA5<-NULL
#   SRA6<-NULL
#   SRA7<-NULL
#   SRA8<-NULL
#   SRA9<-NULL
#   SRA10<-NULL
})
lbw.for.glm<-na.omit(lbw.for.glm)
res.best.glm<-
bestglm(Xy=lbw.for.glm,
family=gaussian,
IC="AIC",
method="exhaustive")
summary(lbw.for.glm$y)
res.best.glm$BestModels
best.model.lm1<-lm(don~UG1+UG2+TG2+SRA2+SRA3+SRA4+SRA5+SRA6+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
best.model.lm1<-lm(don~UG1+UG2+TG2+SRA2+SRA3+SRA4+SRA5+SRA6+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
best.model.lm2<-lm(don~UG1+UG2+TG2+SRA1+SRA2+SRA3+SRA4+SRA5+SRA6+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
best.model.lm3<-lm(don~UG1+UG2+TG1+TG2+PGG+SRA2+SRA3+SRA4+SRA5+SRA6+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
best.model.lm4<-lm(don~UG1+UG2+TG2+SRA1+SRA3+SRA4+SRA5+SRA6+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
best.model.lm5<-lm(don~UG1+UG2+TG1+TG2+SRA2+SRA3+SRA4+SRA5+SRA6+yr2017+yr2016+yr2015+yr2014+yr2013+GENDER+humanities+stem, data=data)
stargazer(best.model.lm3, best.model.lm5, best.model.lm2, best.model.lm4,
best.model.lm1,type="latex",
dep.var.labels=c("Log(Donations)")
)
stargazer(best.model.lm3, best.model.lm5, best.model.lm2, best.model.lm4,
best.model.lm1,type="latex",
dep.var.labels=c("Log(Average Donations)"),
covariate.labels=c("Ultimatum1","Ultimatum2", "Trust1", "Trust2","Cooperation", "SRA1","SRA2", "SRA3", "SRA4", "SRA5", "SRA6",
"2017", "2016", "2015", "2014", "2013", "Female",
"Humanities", "STEM"))
avgdonations<-ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5, fill="slategray4")+
labs(x="Log(Average Donations)", y="Percent")+
ggtitle("Panel L: Log of Average Donations")
ggplot(data=data, aes(data$don))+geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=0.5, fill="slategray4")+
labs(x="Log(Average Donations)", y="Percent")+
ggtitle("Panel L: Log of Average Donations")
pdf("~/Desktop/thesis/paper/images/Figure4.pdf",width=11,height=8.5)
grid.arrange(donations,avgdonations, nrow=2)
dev.off()
avgdonation<-ggplot(df, aes(classyr, avgdonations)) + geom_bar(stat="identity", fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Donation Amounts")+
ggtitle("Panel O: Average Donation Amount by Class Year")
ggplot(df, aes(classyr, avgdonations)) + geom_bar(stat="identity", fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Donation Amounts")+
ggtitle("Panel O: Average Donation Amount by Class Year")
pdf("~/Desktop/thesis/paper/images/Figure6.pdf",width=11,height=8.5)
grid.arrange(avgdonated,avgdonation, nrow=2)
dev.off()
avgdonated<-ggplot(df, aes(classyr, donated)) + geom_bar(stat="identity", fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Percent Donated")+
ggtitle("Panel M: Percent Donated by Class Year")
avgdonation<-ggplot(df, aes(classyr, avgdonations)) + geom_bar(stat="identity", fill="slategray4") +
#geom_histogram(aes(y=100*(..count..)/sum(..count..)), binwidth=5)+
labs(x="Class Year", y="Average Donation Amounts")+
ggtitle("Panel N: Average Donation Amount by Class Year")
pdf("~/Desktop/thesis/paper/images/Figure6.pdf",width=11,height=8.5)
grid.arrange(avgdonated,avgdonation, nrow=2)
dev.off()
model1<-lm(don~alpha+GENDER+humanities+stem, data=data)
model2<-lm(don~rho1+GENDER+humanities+stem, data=data)
model3<-lm(don~UG1+GENDER+humanities+stem, data=data)
model4<-lm(don~UG2+GENDER+humanities+stem, data=data)
model5<-lm(don~TG1+GENDER+humanities+stem, data=data)
model6<-lm(don~TG2+GENDER+humanities+stem, data=data)
model7<-lm(don~PGG+GENDER+humanities+stem, data=data)
model8<-lm(don~alpha+rho1+UG1+UG2+TG1+TG2+PGG+GENDER+humanities+stem, data=data)
model9<- lm(don~SRAtotal+GENDER+humanities+stem, data=data)
model10<-lm(don~SRAmoney+GENDER+humanities+stem, data=data)
model11 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAtotal+GENDER+humanities+stem, data=data)
model12 <- lm(don ~ alpha +rho1+ UG1 + UG2 + TG1 + TG2 + PGG + SRAmoney+GENDER+humanities+stem, data=data)
model12<-glm(donated~alpha+GENDER+humanities+stem, data=data)
pR2(model12)
